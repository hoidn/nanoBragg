ERROR Default `None` is not assignable to parameter `config` with type `CrystalConfig` [bad-function-definition]
  --> /Users/ollie/Documents/nanoBragg/src/nanobrag_torch/models/crystal.py:38:48
   |
38 |     def __init__(self, config: CrystalConfig = None, device=None, dtype=torch.float64):
   |                                                ^^^^
   |
ERROR `Tensor` is not assignable to attribute `hkl_data` with type `None` [bad-assignment]
   --> /Users/ollie/Documents/nanoBragg/src/nanobrag_torch/models/crystal.py:149:29
    |
149 |             self.hkl_data = torch.tensor(hkl_list, device=self.device, dtype=self.dtype)
    |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
ERROR `Tensor` is not assignable to attribute `hkl_data` with type `None` [bad-assignment]
   --> /Users/ollie/Documents/nanoBragg/src/nanobrag_torch/models/crystal.py:152:29
    |
152 |             self.hkl_data = torch.empty((0, 4), device=self.device, dtype=self.dtype)
    |                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
ERROR `**` is not supported between `Tensor` and `Literal[2]` [unsupported-operation]
   --> /Users/ollie/Documents/nanoBragg/src/nanobrag_torch/models/crystal.py:364:55
    |
364 |         sin_gamma_star = torch.sqrt(torch.clamp(1.0 - cos_gamma_star_clamped**2, min=0.0))
    |                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^
    |
  Argument `Literal[2]` is not assignable to parameter with type `TensorBase`
ERROR `**` is not supported between `Tensor` and `Literal[2]` [unsupported-operation]
   --> /Users/ollie/Documents/nanoBragg/src/nanobrag_torch/models/crystal.py:364:55
    |
364 |         sin_gamma_star = torch.sqrt(torch.clamp(1.0 - cos_gamma_star_clamped**2, min=0.0))
    |                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^
    |
  Expected 1 more positional argument
ERROR Object of class `float` has no attribute `unsqueeze` [missing-attribute]
   --> /Users/ollie/Documents/nanoBragg/src/nanobrag_torch/models/crystal.py:583:26
    |
583 |             phi_angles = phi_angles.unsqueeze(0)  # Add batch dimension
    |                          ^^^^^^^^^^^^^^^^^^^^
    |
ERROR No matching overload found for function `torch._C._VariableFunctions.any` [no-matching-overload]
   --> /Users/ollie/Documents/nanoBragg/src/nanobrag_torch/models/crystal.py:615:21
    |
615 |         if torch.any(config.mosaic_spread_deg > 0.0):
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
  Possible overloads:
  (input: Tensor, *, out: Tensor | None = None) -> Tensor [closest match]
  (input: Tensor, dim: Unknown | None = None, keepdim: bool = False, *, out: Tensor | None = None) -> Tensor
  (input: Tensor, dim: int, keepdim: bool = False, *, out: Tensor | None = None) -> Tensor
  (input: Tensor, dim: EllipsisType | str | None, keepdim: bool = False, *, out: Tensor | None = None) -> Tensor
ERROR Argument `float` is not assignable to parameter `input` with type `Tensor` in function `torch._C._VariableFunctions.deg2rad` [bad-argument-type]
   --> /Users/ollie/Documents/nanoBragg/src/nanobrag_torch/models/crystal.py:651:43
    |
651 |         mosaic_spread_rad = torch.deg2rad(config.mosaic_spread_deg)
    |                                           ^^^^^^^^^^^^^^^^^^^^^^^^
    |
ERROR `_NotImplementedType | float | Unknown` is not assignable to attribute `beam_center_s` with type `Tensor` [bad-assignment]
  --> /Users/ollie/Documents/nanoBragg/src/nanobrag_torch/models/detector.py:49:34
   |
49 |             self.beam_center_s = config.beam_center_s / config.pixel_size_mm
   |                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
ERROR `_NotImplementedType | float | Unknown` is not assignable to attribute `beam_center_f` with type `Tensor` [bad-assignment]
  --> /Users/ollie/Documents/nanoBragg/src/nanobrag_torch/models/detector.py:54:34
   |
54 |             self.beam_center_f = config.beam_center_f / config.pixel_size_mm
   |                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |
ERROR Returned type `Tensor | bool` is not assignable to declared return type `bool` [bad-return]
   --> /Users/ollie/Documents/nanoBragg/src/nanobrag_torch/models/detector.py:102:16
    |
102 |         return basic_check and convention_check and rotx_check and roty_check and rotz_check and twotheta_check
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |
ERROR `Tensor` is not assignable to attribute `_pixel_coords_cache` with type `None` [bad-assignment]
   --> /Users/ollie/Documents/nanoBragg/src/nanobrag_torch/models/detector.py:162:40
    |
162 |             self._pixel_coords_cache = pixel_coords
    |                                        ^^^^^^^^^^^^
    |
ERROR Returned type `None` is not assignable to declared return type `Tensor` [bad-return]
   --> /Users/ollie/Documents/nanoBragg/src/nanobrag_torch/models/detector.py:164:16
    |
164 |         return self._pixel_coords_cache
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |
ERROR Default `None` is not assignable to parameter `crystal_config` with type `CrystalConfig` [bad-function-definition]
  --> /Users/ollie/Documents/nanoBragg/src/nanobrag_torch/simulator.py:31:41
   |
31 |         crystal_config: CrystalConfig = None,
   |                                         ^^^^
   |
ERROR Default `None` is not assignable to parameter `beam_config` with type `BeamConfig` [bad-function-definition]
  --> /Users/ollie/Documents/nanoBragg/src/nanobrag_torch/simulator.py:32:35
   |
32 |         beam_config: BeamConfig = None,
   |                                   ^^^^
   |
ERROR `**` is not supported between `Tensor` and `Literal[2]` [unsupported-operation]
   --> /Users/ollie/Documents/nanoBragg/src/nanobrag_torch/simulator.py:223:24
    |
223 |         omega_pixel = (pixel_size_m**2) / (airpath_m**2) * close_distance_m / airpath_m
    |                        ^^^^^^^^^^^^^^^
    |
  Argument `Literal[2]` is not assignable to parameter with type `TensorBase`
ERROR `**` is not supported between `Tensor` and `Literal[2]` [unsupported-operation]
   --> /Users/ollie/Documents/nanoBragg/src/nanobrag_torch/simulator.py:223:24
    |
223 |         omega_pixel = (pixel_size_m**2) / (airpath_m**2) * close_distance_m / airpath_m
    |                        ^^^^^^^^^^^^^^^
    |
  Expected 1 more positional argument
ERROR `**` is not supported between `Tensor` and `Literal[2]` [unsupported-operation]
   --> /Users/ollie/Documents/nanoBragg/src/nanobrag_torch/simulator.py:223:44
    |
223 |         omega_pixel = (pixel_size_m**2) / (airpath_m**2) * close_distance_m / airpath_m
    |                                            ^^^^^^^^^^^^
    |
  Argument `Literal[2]` is not assignable to parameter with type `TensorBase`
ERROR `**` is not supported between `Tensor` and `Literal[2]` [unsupported-operation]
   --> /Users/ollie/Documents/nanoBragg/src/nanobrag_torch/simulator.py:223:44
    |
223 |         omega_pixel = (pixel_size_m**2) / (airpath_m**2) * close_distance_m / airpath_m
    |                                            ^^^^^^^^^^^^
    |
  Expected 1 more positional argument
 INFO 19 errors
