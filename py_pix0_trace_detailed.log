================================================================================
ULTRA-DETAILED PIX0_VECTOR CALCULATION TRACE
================================================================================

CONFIGURATION:
PIX0_PY:distance_mm=100
PIX0_PY:beam_center_s=51.2
PIX0_PY:beam_center_f=51.2
PIX0_PY:pixel_size_mm=0.1
PIX0_PY:detector_rotx_deg=5
PIX0_PY:detector_roty_deg=3
PIX0_PY:detector_rotz_deg=2
PIX0_PY:detector_twotheta_deg=20
PIX0_PY:detector_pivot=sample
PIX0_PY:detector_convention=mosflm

ANGLE CONVERSION:
PIX0_PY:rotx_rad=0.0872664600610733
PIX0_PY:roty_rad=0.0523598790168762
PIX0_PY:rotz_rad=0.0349065847694874
PIX0_PY:twotheta_rad=0.349065840244293

INITIAL BASIS VECTORS (MOSFLM):
PIX0_PY:fdet_initial=[0 0 1]
PIX0_PY:sdet_initial=[0 -1 0]
PIX0_PY:odet_initial=[1 0 0]

PIX0 CALCULATION (BEFORE ROTATIONS - SAMPLE PIVOT):
PIX0_PY:beam_center_f_plus_half=51.7
PIX0_PY:beam_center_s_plus_half=51.7
PIX0_PY:Fclose_m=0.00517
PIX0_PY:Sclose_m=0.00517
PIX0_PY:distance_m=0.1
PIX0_PY:fdet_component=[-0 -0 -0.00517]
PIX0_PY:sdet_component=[-0 0.00517 -0]
PIX0_PY:odet_component=[0.1 0 0]
PIX0_PY:pix0_unrotated=[0.1 0.00517 -0.00517]

ROTATION MATRIX CONSTRUCTION:

X-AXIS ROTATION:
PIX0_PY:rot_x_angle_rad=0.0872664600610733
PIX0_PY:rot_x_cos=0.996194698313003
PIX0_PY:rot_x_sin=0.0871557402186753
PIX0_PY:rot_x_matrix_row0=[1 0 0]
PIX0_PY:rot_x_matrix_row1=[0 0.996194698313003 -0.0871557402186753]
PIX0_PY:rot_x_matrix_row2=[0 0.0871557402186753 0.996194698313003]

Y-AXIS ROTATION:
PIX0_PY:rot_y_angle_rad=0.0523598790168762
PIX0_PY:rot_y_cos=0.998629534678318
PIX0_PY:rot_y_sin=0.0523359576979933
PIX0_PY:rot_y_matrix_row0=[0.998629534678318 0 0.0523359576979933]
PIX0_PY:rot_y_matrix_row1=[0 1 0]
PIX0_PY:rot_y_matrix_row2=[-0.0523359576979933 0 0.998629534678318]

Z-AXIS ROTATION:
PIX0_PY:rot_z_angle_rad=0.0349065847694874
PIX0_PY:rot_z_cos=0.999390827028533
PIX0_PY:rot_z_sin=0.0348994964322665
PIX0_PY:rot_z_matrix_row0=[0.999390827028533 -0.0348994964322665 0]
PIX0_PY:rot_z_matrix_row1=[0.0348994964322665 0.999390827028533 0]
PIX0_PY:rot_z_matrix_row2=[0 0 1]

TWO-THETA ROTATION:
PIX0_PY:twotheta_angle_rad=0.349065840244293
PIX0_PY:twotheta_cos=0.939692624258977
PIX0_PY:twotheta_sin=0.342020133783492
PIX0_PY:twotheta_axis=[0 1 0]
PIX0_PY:twotheta_axis_norm=1
PIX0_PY:twotheta_axis_normalized=[0 1 0]
PIX0_PY:twotheta_ux=0
PIX0_PY:twotheta_uy=1
PIX0_PY:twotheta_uz=0
PIX0_PY:twotheta_cross_product_matrix_row0=[0 -0 1]
PIX0_PY:twotheta_cross_product_matrix_row1=[0 0 -0]
PIX0_PY:twotheta_cross_product_matrix_row2=[-1 0 0]
PIX0_PY:twotheta_outer_product_row0=[0 0 0]
PIX0_PY:twotheta_outer_product_row1=[0 1 0]
PIX0_PY:twotheta_outer_product_row2=[0 0 0]
PIX0_PY:twotheta_K_squared_row0=[-1 0 0]
PIX0_PY:twotheta_K_squared_row1=[0 0 0]
PIX0_PY:twotheta_K_squared_row2=[0 0 -1]
PIX0_PY:twotheta_matrix_row0=[0.939692624258977 0 0.342020133783492]
PIX0_PY:twotheta_matrix_row1=[0 1 0]
PIX0_PY:twotheta_matrix_row2=[-0.342020133783492 0 0.939692624258977]

COMBINED ROTATION MATRIX CONSTRUCTION:
PIX0_PY:R1_Rx_row0=[1 0 0]
PIX0_PY:R1_Rx_row1=[0 0.996194698313003 -0.0871557402186753]
PIX0_PY:R1_Rx_row2=[0 0.0871557402186753 0.996194698313003]
PIX0_PY:R2_Ry_Rx_row0=[0.998629534678318 0.00456137913322189 0.0521368035898745]
PIX0_PY:R2_Ry_Rx_row1=[0 0.996194698313003 -0.0871557402186753]
PIX0_PY:R2_Ry_Rx_row2=[-0.0523359576979933 0.0870362962991201 0.994829448025321]
PIX0_PY:R3_Rz_Ry_Rx_row0=[0.998021196557283 -0.0302080928552761 0.0551467347031221]
PIX0_PY:R3_Rz_Ry_Rx_row1=[0.0348516678826619 0.995747033263258 -0.0852830991065512]
PIX0_PY:R3_Rz_Ry_Rx_row2=[-0.0523359576979933 0.0870362962991201 0.994829448025321]
PIX0_PY:R_combined_final_row0=[0.919933206005442 0.00138184365521141 0.392072680757868]
PIX0_PY:R_combined_final_row1=[0.0348516678826619 0.995747033263258 -0.0852830991065512]
PIX0_PY:R_combined_final_row2=[-0.390523056597616 0.0921191416348077 0.915972601124139]

APPLYING ROTATION TO PIX0:
PIX0_PY:pix0_rotated_final=[0.0899734489727235 0.0090740925726181 -0.0433116280453215]

ROTATED BASIS VECTORS:
PIX0_PY:fdet_rotated=[0.392072680757868 -0.0852830991065512 0.915972601124139]
PIX0_PY:sdet_rotated=[-0.00138184365521141 -0.995747033263258 -0.0921191416348077]
PIX0_PY:odet_rotated=[0.919933206005442 0.0348516678826619 -0.390523056597616]

ORTHONORMALITY VERIFICATION:
PIX0_PY:fdet_norm=1
PIX0_PY:sdet_norm=1
PIX0_PY:odet_norm=1
PIX0_PY:fdet_dot_sdet=2.77555756156289e-17
PIX0_PY:fdet_dot_odet=0
PIX0_PY:sdet_dot_odet=-6.93889390390723e-18

COMPARISON WITH DETECTOR CLASS:
PIX0_PY:detector_fdet_vec=[0.022652442886597 -0.0990011927852581 0.994829448025321]
PIX0_PY:detector_sdet_vec=[-0.312179211482181 -0.946027918744947 -0.0870362962991201]
PIX0_PY:detector_odet_vec=[0.949753129370803 -0.308593487912821 -0.0523359576979933]
PIX0_PY:detector_pix0_vector=[0.109813559827604 0.0226983931746408 -0.0517579947957671]

DIFFERENCE ANALYSIS:
PIX0_PY:fdet_difference=[0.369420237871271 0.0137180936787068 -0.0788568469011824]
PIX0_PY:sdet_difference=[0.31079736782697 -0.0497191145183108 -0.00508284533568761]
PIX0_PY:odet_difference=[-0.0298199233653607 0.343445155795483 -0.338187098899623]
PIX0_PY:pix0_difference=[-0.0198401108548805 -0.0136243006020227 0.00844636675044566]
PIX0_PY:fdet_diff_norm=0.377991931853367
PIX0_PY:sdet_diff_norm=0.314790135667184
PIX0_PY:odet_diff_norm=0.482922681938883
PIX0_PY:pix0_diff_norm=0.0255067182701197

================================================================================
PIX0 DETAILED TRACE COMPLETE
================================================================================

Key values to compare with C implementation:
  pix0_vector: [0.0899734489727235, 0.0090740925726181, -0.0433116280453215]
  Expected C:  [0.09523, 0.05882, -0.05170] (from problem statement)
