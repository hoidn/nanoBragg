================================================================================
Phase M2 Chunk 07 - Test Suite Triage Execution Summary
================================================================================

Timestamp: 20251011T193829Z
Chunk: 07 of test suite triage Phase M2

================================================================================
EXECUTION SUMMARY
================================================================================

Exit Code: 1 (FAILURE)

Test Results:
  - PASSED:  59
  - FAILED:  1
  - SKIPPED: 3
  - TOTAL:   63

Runtime: 19.56 seconds

================================================================================
FAILED TESTS
================================================================================

1. tests/test_at_parallel_003.py::TestATParallel003::test_detector_offset_preservation

   Failure Details:
   - AssertionError: Beam center S pixels incorrect for 256x256
   - Expected: 200.0 pixels
   - Actual: 200.5 pixels
   - Difference: 0.5 pixels (exceeds tolerance of 0.01)

   Root Cause:
   The test expects that when beam centers are explicitly provided in mm, they
   should be used as-is without the MOSFLM +0.5 pixel offset. However, the
   Detector implementation is applying the +0.5 offset regardless of whether
   beam centers are explicitly provided or auto-calculated.

   This indicates a bug in the detector beam center handling logic where the
   MOSFLM convention +0.5 offset should ONLY apply to auto-calculated defaults,
   not to explicitly provided beam center values.

================================================================================
SKIPPED TESTS
================================================================================

1. tests/test_at_parallel_013.py::TestATParallel013CrossPlatformConsistency::test_c_pytorch_equivalence
2. tests/test_at_parallel_024.py::TestAT_PARALLEL_024::test_c_pytorch_equivalence
3. tests/test_at_perf_005.py::TestATPERF005CompilationOptimization::test_gpu_kernel_compilation

Note: These are expected skips (C binary comparisons and GPU tests on CPU-only run)

================================================================================
PERFORMANCE NOTES
================================================================================

Slowest 5 tests:
1. test_cli_roi_edge_cases: 2.79s
2. test_cli_roi_different_conventions: 2.63s
3. test_pytorch_consistency_across_runs: 2.29s
4. test_peak_position_at_offset_beam_centers: 2.25s
5. test_cli_roi_with_noise: 1.48s

All performance tests (test_at_perf_005.py) passed successfully, demonstrating:
- torch.compile speedup verification
- Hot function compilation effectiveness
- Compilation amortization
- dtype optimization impact

================================================================================
TEST FILES EXECUTED
================================================================================

1. tests/test_at_cli_005.py (4 tests - ALL PASSED)
2. tests/test_at_geo_004.py (6 tests - ALL PASSED)
3. tests/test_at_parallel_003.py (3 tests - 1 FAILED, 2 PASSED)
4. tests/test_at_parallel_013.py (6 tests - 5 PASSED, 1 SKIPPED)
5. tests/test_at_parallel_024.py (6 tests - 5 PASSED, 1 SKIPPED)
6. tests/test_at_perf_005.py (5 tests - 4 PASSED, 1 SKIPPED)
7. tests/test_at_sam_003.py (3 tests - ALL PASSED)
8. tests/test_at_str_004.py (5 tests - ALL PASSED)
9. tests/test_detector_basis_vectors.py (7 tests - ALL PASSED)
10. tests/test_parity_coverage_lint.py (8 tests - ALL PASSED)
11. tests/test_units.py (10 tests - ALL PASSED)

================================================================================
RECOMMENDATIONS
================================================================================

1. CRITICAL: Fix beam center offset logic in Detector class
   - The MOSFLM +0.5 pixel offset should ONLY apply when beam centers are
     auto-calculated (centered on detector), NOT when explicitly provided
   - This is a clear violation of the expected behavior documented in the test
   - See: tests/test_at_parallel_003.py lines 119-122 for specification

2. The failure affects detector geometry calculations and could impact:
   - Beam center preservation across different detector sizes
   - Peak position accuracy in parallel validation tests
   - Any downstream calculations that depend on accurate beam center placement

3. High pass rate (93.7%) indicates most functionality is working correctly
   - CLI, geometry, sampling, structure factor, and utility tests all passing
   - Performance optimization tests demonstrate compilation benefits
   - Parity coverage linting validates documentation consistency

================================================================================
OUTPUT FILES
================================================================================

Full pytest output: reports/2026-01-test-suite-triage/phase_m/20251011T193829Z/chunks/chunk_07/pytest.log
Summary report: reports/2026-01-test-suite-triage/phase_m/20251011T193829Z/chunks/chunk_07/summary.txt

================================================================================
