WARNING: auto-generating odet_vector
nanoBragg nanocrystal diffraction simulator - James Holton and Ken Frankel 5-17-17
custom convention selected.
pivoting detector around sample
TRACE_C:detector_convention=CUSTOM
TRACE_C:angles_rad=rotx:0 roty:0 rotz:0 twotheta:0
TRACE_C:beam_center_m=Xclose:0.000211818 Yclose:0.000217322 pixel_mm:0.172
TRACE_C:initial_fdet=0.999982004873912 -0.00599800002923425 -0.000118000000575132
TRACE_C:initial_sdet=-0.0059979996566955 -0.999969942765222 -0.0049129997187971
TRACE_C:initial_odet=-8.85282813644494e-05 0.00491361907271126 -0.999987924182263
TRACE_C:Fclose_m=0.217742295
TRACE_C:Sclose_m=0.21390708
TRACE_C:close_distance_m=0.231271826111781
TRACE_C:ratio=0.999987746654913
TRACE_C:distance_m=0.23127466
TRACE_C:term_fast_before_rot=-0.217738376699947 0.00130601829177553 2.56935909352306e-05
TRACE_C:term_slow_before_rot=0.00128301459240474 0.213900650544676 0.00105092542388871
TRACE_C:term_close_before_rot=-2.04740972936938e-05 0.00113638165576361 -0.231269033315361
TRACE_C:pix0_before_rotation=-0.216475836204836 0.216343050492215 -0.230192414300537
TRACE_C:pix0_after_rotz=-0.216475836204836 0.216343050492215 -0.230192414300537
TRACE_C:pix0_after_twotheta=-0.216475836204836 0.216343050492215 -0.230192414300537
TRACE_C:fdet_after_rotz=0.999982004873912 -0.00599800002923425 -0.000118000000575132
TRACE_C:sdet_after_rotz=-0.0059979996566955 -0.999969942765222 -0.0049129997187971
TRACE_C:odet_after_rotz=-8.85282813644494e-05 0.00491361907271126 -0.999987924182263
TRACE_C:twotheta_axis=0 1 0
TRACE_C:fdet_after_twotheta=0.999982004873912 -0.00599800002923425 -0.000118000000575132
TRACE_C:sdet_after_twotheta=-0.0059979996566955 -0.999969942765222 -0.0049129997187971
TRACE_C:odet_after_twotheta=-8.85282813644494e-05 0.00491361907271126 -0.999987924182263
DETECTOR_FAST_AXIS 0.999982004873912 -0.00599800002923425 -0.000118000000575132
DETECTOR_SLOW_AXIS -0.0059979996566955 -0.999969942765222 -0.0049129997187971
DETECTOR_NORMAL_AXIS -8.85282813644494e-05 0.00491361907271126 -0.999987924182263
DETECTOR_PIX0_VECTOR -0.216475836204836 0.216343050492215 -0.230192414300537
XDS incident beam: 0.00063187 0.00490992 0.999988
reading A.mat
TRACE: Raw matrix values from file:
TRACE:   a_star (raw) = [-0.0283771, -0.0287139, 0.0105005]
TRACE:   b_star (raw) = [-0.00305386, 0.0101955, -0.0320944]
TRACE:   c_star (raw) = [0.0253582, -0.0140005, -0.0103605]
TRACE:   lambda0 = 0.9768 Angstroms
TRACE:   scaling factor = 1e-10/lambda0 = 1.02375
TRACE: After wavelength correction:
TRACE:   a_star = [-0.0290511, -0.0293959, 0.0107499] |a_star| = 0.0427041
TRACE:   b_star = [-0.00312639, 0.0104376, -0.0328567] |b_star| = 0.0346162
TRACE:   c_star = [0.0259604, -0.014333, -0.0106066] |c_star| = 0.0314941
TRACE: Computing cross products of reciprocal vectors:
TRACE:   Input vectors for cross products:
TRACE:     a_star = [-0.0290511, -0.0293959, 0.0107499]
TRACE:     b_star = [-0.00312639, 0.0104376, -0.0328567]
TRACE:     c_star = [0.0259604, -0.014333, -0.0106066]
TRACE:   Cross product results:
TRACE:     a_star x b_star = [0.000853648, -0.000988131, -0.000395128]
TRACE:     b_star x c_star = [-0.000581643, -0.000886134, -0.000226155]
TRACE:     c_star x a_star = [-0.000465869, 2.90622e-05, -0.00117952]
TRACE: Reciprocal cell volume calculation:
TRACE:   V_star = a_star . (b_star x c_star) = 4.05149e-05
TRACE: Direct-space cell volume: V_cell = 1/V_star = 24682.3
TRACE: Before computing real-space vectors:
TRACE:   b_star_cross_c_star = [-0.000581643, -0.000886134, -0.000226155]
TRACE:   c_star_cross_a_star = [-0.000465869, 2.90622e-05, -0.00117952]
TRACE:   a_star_cross_b_star = [0.000853648, -0.000988131, -0.000395128]
TRACE:   V_cell = 24682.3, V_star = 4.05149e-05
TRACE: After computing real-space vectors:
TRACE:   a = [-14.3563, -21.8718, -5.58202] |a| = 26.7514
TRACE:   b = [-11.4987, 0.71732, -29.1132] |b| = 31.31
TRACE:   c = [21.07, -24.3893, -9.75265] |c| = 33.6734
TRACE: Re-generating reciprocal vectors from real-space vectors:
TRACE:   Before re-generation: a_star = [-0.0290511, -0.0293959, 0.0107499] |a_star| = 0.0427041
TRACE:   Before re-generation: b_star = [-0.00312639, 0.0104376, -0.0328567] |b_star| = 0.0346162
TRACE:   Before re-generation: c_star = [0.0259604, -0.014333, -0.0106066] |c_star| = 0.0314941
TRACE:   Cross products: b_cross_c = [-717.047, -725.557, 265.331]
TRACE:   Cross products: c_cross_a = [-77.1664, 257.625, -810.977]
TRACE:   Cross products: a_cross_b = [640.762, -353.771, -261.795]
TRACE:   After re-generation: a_star = [-0.0290511, -0.0293959, 0.0107499] |a_star| = 0.0427041
TRACE:   After re-generation: b_star = [-0.00312639, 0.0104376, -0.0328567] |b_star| = 0.0346162
TRACE:   After re-generation: c_star = [0.0259604, -0.014333, -0.0106066] |c_star| = 0.0314941
Unit Cell: 26.7514 31.31 33.6734 88.687 71.5295 68.1375
Recp Cell: 0.0427041 0.0346162 0.0314941 83.8005 109.406 112.647
volume = 24682.3 A^3
real-space cell vectors (Angstrom):
     a           b           c         
X: -14.35626903 -11.49869684 21.06995003
Y: -21.87179285  0.71732003 -24.38929625
Z: -5.58202083 -29.11321478 -9.75265167
reciprocal-space cell vectors (Angstrom^-1):
     a_star      b_star      c_star    
X: -0.02905110 -0.00312639  0.02596044
Y: -0.02939588  0.01043764 -0.01433302
Z:  0.01074988 -0.03285667 -0.01060661
TRACE: Converting real-space vectors from Angstroms to meters:
TRACE:   Before conversion: a = [-14.3563, -21.8718, -5.58202] |a| = 26.7514 Angstroms
TRACE:   Before conversion: b = [-11.4987, 0.71732, -29.1132] |b| = 31.31 Angstroms
TRACE:   Before conversion: c = [21.07, -24.3893, -9.75265] |c| = 33.6734 Angstroms
TRACE:   After conversion: a = [-1.43563e-09, -2.18718e-09, -5.58202e-10] |a| = 2.67514e-09 meters
TRACE:   After conversion: b = [-1.14987e-09, 7.1732e-11, -2.91132e-09] |b| = 3.131e-09 meters
TRACE:   After conversion: c = [2.107e-09, -2.43893e-09, -9.75265e-10] |c| = 3.36734e-09 meters
TRACE: Copying vectors to a0, b0, c0 (phi=0 mosaic=0 reference):
TRACE:   a0 = [-1.43563e-09, -2.18718e-09, -5.58202e-10] |a0| = 2.67514e-09 meters
TRACE:   b0 = [-1.14987e-09, 7.1732e-11, -2.91132e-09] |b0| = 3.131e-09 meters
TRACE:   c0 = [2.107e-09, -2.43893e-09, -9.75265e-10] |c0| = 3.36734e-09 meters
TRACE: Copying vectors to ap, bp, cp (phi=0 working copy):
TRACE:   ap = [-1.43563e-09, -2.18718e-09, -5.58202e-10] |ap| = 2.67514e-09 meters
TRACE:   bp = [-1.14987e-09, 7.1732e-11, -2.91132e-09] |bp| = 3.131e-09 meters
TRACE:   cp = [2.107e-09, -2.43893e-09, -9.75265e-10] |cp| = 3.36734e-09 meters
crystal is 0.096305 x 0.147157 x 0.0976527 microns
WARNING: maximum dimension of sample is 1471.57 A
         but reciprocal pixel size is 1313.42 A
         intensity may vary significantly across a pixel!
         recommend -oversample 4 to work around this
approximate MW = 20382
counting entries in scaled.hkl
re-reading scaled.hkl
writing dump file for next time: Fdump.bin
thick0 = 0 um
phi0 = 0
phi1 = 0.01
phi2 = 0.02
phi3 = 0.03
phi4 = 0.04
phi5 = 0.05
phi6 = 0.06
phi7 = 0.07
phi8 = 0.08
phi9 = 0.09
divergence deviation: 0 0
lambda0 = 9.768e-11
  created a total of 1 sources:
-0.00513879 0 10   1 9.768e-11
  created a total of 1 mosaic domains
  64333 initialized hkls (all others =0)
  parallelpiped xtal: 36x47x29 cells
  wave=9.768e-11 meters +/- 0% in 1 steps
  Kahn polarization factor: 0.000000
  incident fluence: 1e+24 photons/m^2
  distance=0.231275 detsize=0.423636x0.434644  pixel=0.000172 meters (2463x2527 pixels)
  sensor is 0 m thick in 1 layers with mu= -1
  Xbeam=0.217742 Ybeam=0.213907
  Fbeam=0.217889 Sbeam=0.215043
  Xclose=0.211818 Yclose=0.217322
  Fclose=0.217742 Sclose=0.213907
  DIRECTION_OF_DETECTOR_X-AXIS= 0.999982 -0.005998 -0.000118
  DIRECTION_OF_DETECTOR_Y-AXIS= -0.005998 -0.99997 -0.004913
  DIRECTION_OF_DETECTOR_Z-AXIS= -8.85283e-05 0.00491362 -0.999988
  INCIDENT_BEAM_DIRECTION= 0.000513879 0 -1
  spindle ROTATION_AXIS= -1 0 0
  POLARIZATION_PLANE_NORMAL= 0 -0.000513879 0
  dials origin= -230.192 216.343 216.476
  roi: 0 < x < 2463 && 0 < y < 2527
  hdivrange=0 hdivstep=0  radians
  vdivrange=0 vdivstep=0  radians
  1 divergence steps
  1 sources
  1 mosaic domains over mosaic spread of 0 degrees
  10 phi steps from 0 to 0.1 degrees
  1x1 pixel oversample steps
TRACE_CONFIG: tracing pixel (spixel=685, fpixel=1039)
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
0% done
1% done
1% done
1% done
1% done
1% done
1% done
1% done
1% done
1% done
1% done
1% done
1% done
1% done
1% done
1% done
1% done
1% done
1% done
1% done
1% done
1% done
1% done
1% done
1% done
1% done
1% done
1% done
1% done
1% done
1% done
1% done
1% done
TRACE_C: pix0_vector_meters -0.216475836204836 0.216343050492215 -0.230192414300537
TRACE_C: fdet_vec 0.999982004873912 -0.00599800002923425 -0.000118000000575132
TRACE_C: sdet_vec -0.0059979996566955 -0.999969942765222 -0.0049129997187971
TRACE_C: pixel_pos_meters -0.0383922537729319 0.0973681880033118 -0.230792784137485
TRACE_C: R_distance_meters 0.253416334111961
TRACE_C: omega_pixel_sr 4.20412684465831e-07
TRACE_C: close_distance_meters 0.231271826111781
TRACE_C: obliquity_factor 0.91261609841457
TRACE_C: diffracted_vec -0.151498733921271 0.384222226023891 -0.910725762592394
TRACE_C: incident_vec 0.000513879494092498 -0 -0.999999867963924
TRACE_C: lambda_meters 9.768e-11
TRACE_C: lambda_angstroms 0.9768
TRACE_C: scattering_vec_A_inv -1556230686.07047 3933478972.39855 913944567.685604
TRACE_C: rot_a_angstroms -14.3562690335399 -21.8805340763623 -5.5476578307123
TRACE_C: rot_b_angstroms -11.4986968432508 0.671588233999813 -29.1143056268565
TRACE_C: rot_c_angstroms 21.0699500320179 -24.4045855811067 -9.7143290320006
TRACE_C: rot_a_star_A_inv -0.0290510954135954 -0.0293958845208845 0.0107498771498771
TRACE_C: rot_b_star_A_inv -0.0031263923013923 0.0104376433251433 -0.0328566748566749
TRACE_C: rot_c_star_A_inv 0.0259604422604423 -0.014333015970516 -0.0106066134316134
TRACE_C: hkl_frac -6.8795206024501 -0.607255839576692 -13.766298525469
TRACE_C: hkl_rounded -7 -1 -14
TRACE_C: F_latt_a -2.36012735995387
TRACE_C: F_latt_b 1.05079664302326
TRACE_C: F_latt_c 0.960961003611676
TRACE_C: F_latt -2.38319665299058
TRACE_C_PHI phi_tic=0 phi_deg=0 k_frac=-0.607255839576692 F_latt_b=1.05079664302326 F_latt=-2.38319665299058
TRACE_C: F_cell 190.27
TRACE_C_PHI phi_tic=1 phi_deg=0.01 k_frac=-0.591177727127411 F_latt_b=-0.650897255741202 F_latt=1.09860741704307
TRACE_C_PHI phi_tic=2 phi_deg=0.02 k_frac=-0.593187745641004 F_latt_b=-0.385020463934971 F_latt=0.679724660042308
TRACE_C_PHI phi_tic=3 phi_deg=0.03 k_frac=-0.595197691574922 F_latt_b=-0.0844254727339029 F_latt=0.155482072719562
TRACE_C_PHI phi_tic=4 phi_deg=0.04 k_frac=-0.597207564867936 F_latt_b=0.224723979612609 F_latt=-0.430675460925897
TRACE_C_PHI phi_tic=5 phi_deg=0.05 k_frac=-0.599217365458823 F_latt_b=0.515419354922621 F_latt=-1.02559631818979
TRACE_C_PHI phi_tic=6 phi_deg=0.06 k_frac=-0.601227093286361 F_latt_b=0.762161832840823 F_latt=-1.57135079979647
TRACE_C_PHI phi_tic=7 phi_deg=0.07 k_frac=-0.60323674828933 F_latt_b=0.943193755044476 F_latt=-2.01093178282
TRACE_C_PHI phi_tic=8 phi_deg=0.08 k_frac=-0.605246330406512 F_latt_b=1.04241217237842 F_latt=-2.29416161853174
TRACE_C_PHI phi_tic=9 phi_deg=0.09 k_frac=-0.607255839576692 F_latt_b=1.05079664302326 F_latt=-2.38319665299058
TRACE_C: I_before_scaling 943654.80923755
TRACE_C: r_e_meters 2.81794117756025e-15
TRACE_C: r_e_sqr 7.94079248018965e-30
TRACE_C: fluence_photons_per_m2 1e+24
TRACE_C: steps 10
TRACE_C: oversample_thick 0
TRACE_C: oversample_polar 0
TRACE_C: oversample_omega 0
TRACE_C: capture_fraction 1
TRACE_C: polar 0.91463969894451
TRACE_C: omega_pixel 4.20412684465831e-07
TRACE_C: cos_2theta 0.910647790250995
TRACE_C: I_pixel_final 2.88139542684698e-07
TRACE_C: floatimage_accumulated 2.88139546000821e-07
2% done
2% done
2% done
2% done
2% done
2% done
2% done
2% done
2% done
2% done
2% done
2% done
2% done
2% done
2% done
2% done
2% done
2% done
2% done
2% done
2% done
2% done
2% done
2% done
2% done
2% done
2% done
2% done
2% done
2% done
2% done
2% done

solid angle subtended by detector = 0.192259 steradian ( 1.52995% sphere)
writing /dev/null as 6224001 4-byte floats
max_I = 446.254  at 0.117906 0.178794
mean= 0.00104287 rms= 0.334386 rmsd= 0.334384
intfile_scale = 123.248
writing intimage.img as 2-byte integers
pgm_scale = 149.529
writing image.pgm as 1-byte integers
