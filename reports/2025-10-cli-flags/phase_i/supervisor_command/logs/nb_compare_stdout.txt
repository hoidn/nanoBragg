C binary: /home/ollie/Documents/tmp/nanoBragg/golden_suite_generator/nanoBragg
PyTorch command: nanoBragg

Running C implementation...
C runtime: 0.541 s
Running PyTorch implementation...
Py runtime: 7.086 s

Loading float images...
Warning: Could not determine image dimensions for 6224001 pixels
Warning: Could not determine image dimensions for 6224001 pixels
C image shape: (6224001,)
PyTorch image shape: (6224001,)

Computing metrics...
Traceback (most recent call last):
  File "/home/ollie/Documents/tmp/nanoBragg/scripts/nb_compare.py", line 453, in <module>
    sys.exit(main())
             ~~~~^^
  File "/home/ollie/Documents/tmp/nanoBragg/scripts/nb_compare.py", line 383, in main
    metrics = compute_metrics(c_img, py_img, args.roi)
  File "/home/ollie/Documents/tmp/nanoBragg/scripts/nb_compare.py", line 200, in compute_metrics
    c_peaks = find_peaks(c_img, n_peaks)
  File "/home/ollie/Documents/tmp/nanoBragg/scripts/nb_compare.py", line 234, in find_peaks
    return [(int(coord[0]), int(coord[1]))
                                ~~~~~^^^
IndexError: index 1 is out of bounds for axis 0 with size 1
