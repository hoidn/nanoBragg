============================= test session starts ==============================
platform linux -- Python 3.13.5, pytest-8.4.1, pluggy-1.5.0 -- /home/ollie/miniconda3/bin/python3.13
cachedir: .pytest_cache
rootdir: /home/ollie/Documents/tmp/nanoBragg
configfile: pyproject.toml
testpaths: tests
plugins: anyio-4.9.0
collecting ... collected 692 items / 1 skipped

tests/test_at_abs_001.py::TestAT_ABS_001::test_absorption_disabled_when_zero[cpu] PASSED [  0%]
tests/test_at_abs_001.py::TestAT_ABS_001::test_absorption_disabled_when_zero[cuda] PASSED [  0%]
tests/test_at_abs_001.py::TestAT_ABS_001::test_capture_fraction_calculation[False-cpu] PASSED [  0%]
tests/test_at_abs_001.py::TestAT_ABS_001::test_capture_fraction_calculation[False-cuda] PASSED [  0%]
tests/test_at_abs_001.py::TestAT_ABS_001::test_capture_fraction_calculation[True-cpu] PASSED [  0%]
tests/test_at_abs_001.py::TestAT_ABS_001::test_capture_fraction_calculation[True-cuda] PASSED [  0%]
tests/test_at_abs_001.py::TestAT_ABS_001::test_last_value_vs_accumulation_semantics[cpu] PASSED [  1%]
tests/test_at_abs_001.py::TestAT_ABS_001::test_last_value_vs_accumulation_semantics[cuda] PASSED [  1%]
tests/test_at_abs_001.py::TestAT_ABS_001::test_parallax_dependence[False-cpu] PASSED [  1%]
tests/test_at_abs_001.py::TestAT_ABS_001::test_parallax_dependence[False-cuda] PASSED [  1%]
tests/test_at_abs_001.py::TestAT_ABS_001::test_parallax_dependence[True-cpu] PASSED [  1%]
tests/test_at_abs_001.py::TestAT_ABS_001::test_parallax_dependence[True-cuda] PASSED [  1%]
tests/test_at_abs_001.py::TestAT_ABS_001::test_absorption_with_tilted_detector[False-cpu] PASSED [  1%]
tests/test_at_abs_001.py::TestAT_ABS_001::test_absorption_with_tilted_detector[False-cuda] PASSED [  2%]
tests/test_at_abs_001.py::TestAT_ABS_001::test_absorption_with_tilted_detector[True-cpu] PASSED [  2%]
tests/test_at_abs_001.py::TestAT_ABS_001::test_absorption_with_tilted_detector[True-cuda] PASSED [  2%]
tests/test_at_bkg_001.py::TestAT_BKG_001::test_water_background_calculation PASSED [  2%]
tests/test_at_bkg_001.py::TestAT_BKG_001::test_water_background_zero PASSED [  2%]
tests/test_at_bkg_001.py::TestAT_BKG_001::test_water_background_additive PASSED [  2%]
tests/test_at_cli_001.py::TestAT_CLI_001::test_cli_help_short_flag PASSED [  2%]
tests/test_at_cli_001.py::TestAT_CLI_001::test_cli_help_long_flag PASSED [  3%]
tests/test_at_cli_001.py::TestAT_CLI_001::test_cli_invocable PASSED      [  3%]
tests/test_at_cli_001.py::TestAT_CLI_001::test_cli_help_includes_examples PASSED [  3%]
tests/test_at_cli_001.py::TestAT_CLI_001::test_cli_help_includes_wavelength_synonyms PASSED [  3%]
tests/test_at_cli_001.py::TestAT_CLI_001::test_cli_help_includes_output_synonyms PASSED [  3%]
tests/test_at_cli_002.py::TestAT_CLI_002::test_minimal_render_with_default_F FAILED [  3%]
tests/test_at_cli_002.py::TestAT_CLI_002::test_minimal_render_with_hkl_file PASSED [  3%]
tests/test_at_cli_002.py::TestAT_CLI_002::test_data_ordering_fast_major PASSED [  4%]
tests/test_at_cli_002.py::TestAT_CLI_002::test_error_without_required_inputs PASSED [  4%]
tests/test_at_cli_003.py::TestATCLI003::test_mosflm_default_pivot_beam PASSED [  4%]
tests/test_at_cli_003.py::TestATCLI003::test_xds_default_pivot_sample PASSED [  4%]
tests/test_at_cli_003.py::TestATCLI003::test_pivot_override_mosflm_to_sample PASSED [  4%]
tests/test_at_cli_003.py::TestATCLI003::test_pivot_override_xds_to_beam PASSED [  4%]
tests/test_at_cli_003.py::TestATCLI003::test_convention_header_keys_consistency PASSED [  4%]
tests/test_at_cli_004.py::test_header_precedence_img_then_mask PASSED    [  5%]
tests/test_at_cli_004.py::test_mask_zeros_are_skipped PASSED             [  5%]
tests/test_at_cli_004.py::test_mask_beam_center_y_flip PASSED            [  5%]
tests/test_at_cli_004.py::test_conflicting_detector_size PASSED          [  5%]
tests/test_at_cli_004.py::test_img_only_no_mask PASSED                   [  5%]
tests/test_at_cli_005.py::test_cli_roi_basic PASSED                      [  5%]
tests/test_at_cli_005.py::test_cli_roi_with_noise PASSED                 [  5%]
tests/test_at_cli_005.py::test_cli_roi_edge_cases PASSED                 [  6%]
tests/test_at_cli_005.py::test_cli_roi_different_conventions PASSED      [  6%]
tests/test_at_cli_006.py::test_autoscale_without_scale_flag PASSED       [  6%]
tests/test_at_cli_006.py::test_explicit_scale_flag PASSED                [  6%]
tests/test_at_cli_006.py::test_pgm_without_pgmscale PASSED               [  6%]
tests/test_at_cli_006.py::test_pgm_with_explicit_pgmscale PASSED         [  6%]
tests/test_at_cli_006.py::test_pgm_format_compliance PASSED              [  6%]
tests/test_at_cli_007.py::TestATCLI007NoiseDeterminism::test_identical_seed_produces_identical_noise PASSED [  7%]
tests/test_at_cli_007.py::TestATCLI007NoiseDeterminism::test_different_seed_produces_different_noise PASSED [  7%]
tests/test_at_cli_007.py::TestATCLI007NoiseDeterminism::test_seed_determinism_without_roi PASSED [  7%]
tests/test_at_cli_007.py::TestATCLI007NoiseDeterminism::test_negative_seed_accepted PASSED [  7%]
tests/test_at_cli_007.py::TestATCLI007NoiseDeterminism::test_overload_count_determinism PASSED [  7%]
tests/test_at_cli_008.py::TestATCLI008DminFiltering::test_dmin_filtering_reduces_intensity PASSED [  7%]
tests/test_at_cli_008.py::TestATCLI008DminFiltering::test_dmin_very_strict_removes_most_intensity PASSED [  7%]
tests/test_at_cli_008.py::TestATCLI008DminFiltering::test_dmin_zero_has_no_effect PASSED [  8%]
tests/test_at_cli_009.py::TestATCLI009ErrorHandling::test_missing_hkl_and_fdump_with_default_f_zero PASSED [  8%]
tests/test_at_cli_009.py::TestATCLI009ErrorHandling::test_missing_hkl_but_has_default_f PASSED [  8%]
tests/test_at_cli_009.py::TestATCLI009ErrorHandling::test_missing_cell_parameters PASSED [  8%]
tests/test_at_cli_009.py::TestATCLI009ErrorHandling::test_fdump_fallback PASSED [  8%]
tests/test_at_cli_009.py::TestATCLI009ErrorHandling::test_help_message PASSED [  8%]
tests/test_at_cli_009.py::TestATCLI009ErrorHandling::test_unsupported_flag_dispstep PASSED [  8%]
tests/test_at_cli_009.py::TestATCLI009ErrorHandling::test_unsupported_flag_hdiv PASSED [  9%]
tests/test_at_cli_009.py::TestATCLI009ErrorHandling::test_unsupported_flag_vdiv PASSED [  9%]
tests/test_at_crystal_absolute.py::TestATCrystalAbsolute::test_triclinic_absolute_positions PASSED [  9%]
tests/test_at_crystal_absolute.py::TestATCrystalAbsolute::test_cubic_vs_triclinic_systematic_difference PASSED [  9%]
tests/test_at_crystal_absolute.py::TestATCrystalAbsolute::test_known_reflection_d_spacings PASSED [  9%]
tests/test_at_flu_001.py::TestAT_FLU_001::test_fluence_calculation_from_flux_exposure_beamsize PASSED [  9%]
tests/test_at_flu_001.py::TestAT_FLU_001::test_no_fluence_calculation_when_flux_zero PASSED [  9%]
tests/test_at_flu_001.py::TestAT_FLU_001::test_no_fluence_calculation_when_exposure_zero PASSED [ 10%]
tests/test_at_flu_001.py::TestAT_FLU_001::test_fluence_calculation_with_beamsize_zero PASSED [ 10%]
tests/test_at_flu_001.py::TestAT_FLU_001::test_flux_recomputation_from_fluence_and_exposure PASSED [ 10%]
tests/test_at_flu_001.py::TestAT_FLU_001::test_sample_clipping_warning PASSED [ 10%]
tests/test_at_flu_001.py::TestAT_FLU_001::test_no_clipping_when_beamsize_larger PASSED [ 10%]
tests/test_at_flu_001.py::TestAT_FLU_001::test_no_clipping_when_beamsize_zero PASSED [ 10%]
tests/test_at_geo_001.py::test_at_geo_001_mosflm_beam_center_mapping PASSED [ 10%]
tests/test_at_geo_002.py::test_at_geo_002_setup_a_distance_only PASSED   [ 11%]
tests/test_at_geo_002.py::test_at_geo_002_setup_b_close_distance_only PASSED [ 11%]
tests/test_at_geo_002.py::test_at_geo_002_setup_c_explicit_override PASSED [ 11%]
tests/test_at_geo_002.py::test_at_geo_002_setup_c_beam_override PASSED   [ 11%]
tests/test_at_geo_002.py::test_at_geo_002_direct_instantiation PASSED    [ 11%]
tests/test_at_geo_003.py::TestATGEO003RFactorAndBeamCenter::test_r_factor_calculation PASSED [ 11%]
tests/test_at_geo_003.py::TestATGEO003RFactorAndBeamCenter::test_distance_update_with_close_distance PASSED [ 11%]
tests/test_at_geo_003.py::TestATGEO003RFactorAndBeamCenter::test_beam_center_preservation_beam_pivot PASSED [ 12%]
tests/test_at_geo_003.py::TestATGEO003RFactorAndBeamCenter::test_beam_center_preservation_sample_pivot PASSED [ 12%]
tests/test_at_geo_003.py::TestATGEO003RFactorAndBeamCenter::test_no_rotations_r_factor_equals_one PASSED [ 12%]
tests/test_at_geo_003.py::TestATGEO003RFactorAndBeamCenter::test_beam_center_with_various_rotations[DetectorPivot.BEAM] PASSED [ 12%]
tests/test_at_geo_003.py::TestATGEO003RFactorAndBeamCenter::test_beam_center_with_various_rotations[DetectorPivot.SAMPLE] PASSED [ 12%]
tests/test_at_geo_003.py::TestATGEO003RFactorAndBeamCenter::test_gradients_flow_through_r_factor PASSED [ 12%]
tests/test_at_geo_004.py::test_twotheta_axis_defaults PASSED             [ 13%]
tests/test_at_geo_004.py::test_twotheta_axis_override PASSED             [ 13%]
tests/test_at_geo_004.py::test_twotheta_rotation_applied PASSED          [ 13%]
tests/test_at_geo_004.py::test_twotheta_value_preserved PASSED           [ 13%]
tests/test_at_geo_004.py::test_mosflm_twotheta_rotation PASSED           [ 13%]
tests/test_at_geo_004.py::test_dials_twotheta_rotation PASSED            [ 13%]
tests/test_at_geo_005.py::TestATGEO005CurvedDetector::test_curved_detector_equal_distance PASSED [ 13%]
tests/test_at_geo_005.py::TestATGEO005CurvedDetector::test_curved_vs_planar_difference PASSED [ 14%]
tests/test_at_geo_005.py::TestATGEO005CurvedDetector::test_small_angle_rotation_consistency PASSED [ 14%]
tests/test_at_geo_005.py::TestATGEO005CurvedDetector::test_gradient_flow_curved_detector PASSED [ 14%]
tests/test_at_geo_005.py::TestATGEO005CurvedDetector::test_beam_center_affects_curvature PASSED [ 14%]
tests/test_at_geo_006.py::TestATGEO006PointPixelSolidAngle::test_point_pixel_solid_angle PASSED [ 14%]
tests/test_at_geo_006.py::TestATGEO006PointPixelSolidAngle::test_default_solid_angle_with_obliquity PASSED [ 14%]
tests/test_at_geo_006.py::TestATGEO006PointPixelSolidAngle::test_off_center_pixel_comparison PASSED [ 14%]
tests/test_at_geo_006.py::TestATGEO006PointPixelSolidAngle::test_gradient_flow PASSED [ 15%]
tests/test_at_geo_006.py::TestATGEO006PointPixelSolidAngle::test_corner_pixel_values PASSED [ 15%]
tests/test_at_io_001.py::TestAT_IO_001::test_smv_header_required_keys PASSED [ 15%]
tests/test_at_io_001.py::TestAT_IO_001::test_smv_data_ordering PASSED    [ 15%]
tests/test_at_io_001.py::TestAT_IO_001::test_smv_convention_specific_headers PASSED [ 15%]
tests/test_at_io_001.py::TestAT_IO_001::test_smv_torch_tensor_input PASSED [ 15%]
tests/test_at_io_001.py::TestAT_IO_001::test_smv_byte_order PASSED       [ 15%]
tests/test_at_io_002.py::TestAT_IO_002::test_pgm_header_format PASSED    [ 16%]
tests/test_at_io_002.py::TestAT_IO_002::test_pgm_pixel_scaling PASSED    [ 16%]
tests/test_at_io_002.py::TestAT_IO_002::test_pgm_with_default_scale PASSED [ 16%]
tests/test_at_io_002.py::TestAT_IO_002::test_pgm_torch_tensor_input PASSED [ 16%]
tests/test_at_io_002.py::TestAT_IO_002::test_pgm_clipping_behavior PASSED [ 16%]
tests/test_at_io_003.py::TestAT_IO_003::test_fdump_write_and_read PASSED [ 16%]
tests/test_at_io_003.py::TestAT_IO_003::test_fdump_cache_behavior PASSED [ 16%]
tests/test_at_io_003.py::TestAT_IO_003::test_fdump_no_files_with_default_F PASSED [ 17%]
tests/test_at_io_003.py::TestAT_IO_003::test_fdump_no_files_zero_default PASSED [ 17%]
tests/test_at_io_003.py::TestAT_IO_003::test_fdump_preserves_default_F PASSED [ 17%]
tests/test_at_io_003.py::TestAT_IO_003::test_fdump_header_structure PASSED [ 17%]
tests/test_at_io_004.py::TestAT_IO_004::test_minimal_hkl_format PASSED   [ 17%]
tests/test_at_io_004.py::TestAT_IO_004::test_five_column_with_phase PASSED [ 17%]
tests/test_at_io_004.py::TestAT_IO_004::test_six_column_with_sigma_and_phase PASSED [ 17%]
tests/test_at_io_004.py::TestAT_IO_004::test_negative_indices_handling PASSED [ 18%]
tests/test_at_io_004.py::TestAT_IO_004::test_all_formats_produce_same_pattern PASSED [ 18%]
tests/test_at_io_004.py::TestAT_IO_004::test_fdump_caching_for_all_formats PASSED [ 18%]
tests/test_at_io_004.py::TestAT_IO_004::test_comment_and_blank_line_handling PASSED [ 18%]
tests/test_at_noise_001.py::TestATNoise001::test_small_mean_exact_poisson PASSED [ 18%]
tests/test_at_noise_001.py::TestATNoise001::test_medium_mean_rejection_sampling PASSED [ 18%]
tests/test_at_noise_001.py::TestATNoise001::test_large_mean_gaussian_approximation PASSED [ 18%]
tests/test_at_noise_001.py::TestATNoise001::test_seed_reproducibility PASSED [ 19%]
tests/test_at_noise_001.py::TestATNoise001::test_adc_and_clipping PASSED [ 19%]
tests/test_at_noise_001.py::TestATNoise001::test_all_regimes_in_single_image PASSED [ 19%]
tests/test_at_noise_001.py::TestATNoise001::test_noise_config_integration PASSED [ 19%]
tests/test_at_parallel_001.py::TestATParallel001::test_beam_center_scales_with_detector_size[64] PASSED [ 19%]
tests/test_at_parallel_001.py::TestATParallel001::test_beam_center_scales_with_detector_size[128] PASSED [ 19%]
tests/test_at_parallel_001.py::TestATParallel001::test_beam_center_scales_with_detector_size[256] PASSED [ 19%]
tests/test_at_parallel_001.py::TestATParallel001::test_beam_center_scales_with_detector_size[512] PASSED [ 20%]
tests/test_at_parallel_001.py::TestATParallel001::test_beam_center_scales_with_detector_size[1024] PASSED [ 20%]
tests/test_at_parallel_001.py::TestATParallel001::test_peak_position_at_beam_center PASSED [ 20%]
tests/test_at_parallel_001.py::TestATParallel001::test_cli_beam_center_calculation PASSED [ 20%]
tests/test_at_parallel_001.py::TestATParallel001::test_intensity_scaling_with_solid_angle PASSED [ 20%]
tests/test_at_parallel_002.py::TestATParallel002::test_beam_center_scales_with_pixel_size PASSED [ 20%]
tests/test_at_parallel_002.py::TestATParallel002::test_peak_position_scales_inversely_with_pixel_size PASSED [ 20%]
tests/test_at_parallel_002.py::TestATParallel002::test_pattern_correlation_across_pixel_sizes PASSED [ 21%]
tests/test_at_parallel_002.py::TestATParallel002::test_beam_center_parameter_consistency PASSED [ 21%]
tests/test_at_parallel_003.py::TestATParallel003::test_detector_offset_preservation PASSED [ 21%]
tests/test_at_parallel_003.py::TestATParallel003::test_peak_position_at_offset_beam_centers PASSED [ 21%]
tests/test_at_parallel_003.py::TestATParallel003::test_offset_ratio_preservation PASSED [ 21%]
tests/test_at_parallel_004.py::TestAT_PARALLEL_004::test_mosflm_adds_half_pixel_offset PASSED [ 21%]
tests/test_at_parallel_004.py::TestAT_PARALLEL_004::test_xds_has_no_pixel_offset PASSED [ 21%]
tests/test_at_parallel_004.py::TestAT_PARALLEL_004::test_peak_position_difference PASSED [ 22%]
tests/test_at_parallel_004.py::TestAT_PARALLEL_004::test_pattern_correlation_when_aligned PASSED [ 22%]
tests/test_at_parallel_004.py::TestAT_PARALLEL_004::test_beam_center_calculation_consistency PASSED [ 22%]
tests/test_at_parallel_005.py::TestAT_PARALLEL_005_BeamCenterMapping::test_mosflm_xbeam_ybeam_mapping SKIPPED [ 22%]
tests/test_at_parallel_005.py::TestAT_PARALLEL_005_BeamCenterMapping::test_xds_orgx_orgy_mapping SKIPPED [ 22%]
tests/test_at_parallel_005.py::TestAT_PARALLEL_005_BeamCenterMapping::test_pivot_mode_consistency SKIPPED [ 22%]
tests/test_at_parallel_005.py::TestAT_PARALLEL_005_BeamCenterMapping::test_equivalent_configurations_produce_same_pattern SKIPPED [ 22%]
tests/test_at_parallel_006.py::TestATParallel006SingleReflection::test_bragg_angle_prediction_single_distance PASSED [ 23%]
tests/test_at_parallel_006.py::TestATParallel006SingleReflection::test_distance_scaling PASSED [ 23%]
tests/test_at_parallel_006.py::TestATParallel006SingleReflection::test_combined_wavelength_and_distance PASSED [ 23%]
tests/test_at_parallel_007.py::TestATParallel007PeakPositionWithRotations::test_peak_positions_with_rotations SKIPPED [ 23%]
tests/test_at_parallel_007.py::TestATParallel007PeakPositionWithRotations::test_peak_intensity_ordering SKIPPED [ 23%]
tests/test_at_parallel_007.py::TestATParallel007PeakPositionWithRotations::test_rotation_effect_on_pattern SKIPPED [ 23%]
tests/test_at_parallel_008.py::TestAT_PARALLEL_008::test_triclinic_multi_peak_pattern SKIPPED [ 23%]
tests/test_at_parallel_008.py::TestAT_PARALLEL_008::test_peak_intensity_ordering SKIPPED [ 24%]
tests/test_at_parallel_008.py::TestAT_PARALLEL_008::test_non_max_suppression SKIPPED [ 24%]
tests/test_at_parallel_010.py::TestATParallel010SolidAngleCorrections::test_point_pixel_distance_scaling SKIPPED [ 24%]
tests/test_at_parallel_010.py::TestATParallel010SolidAngleCorrections::test_obliquity_distance_scaling SKIPPED [ 24%]
tests/test_at_parallel_010.py::TestATParallel010SolidAngleCorrections::test_obliquity_with_tilts SKIPPED [ 24%]
tests/test_at_parallel_010.py::TestATParallel010SolidAngleCorrections::test_combined_distance_and_tilt SKIPPED [ 24%]
tests/test_at_parallel_011.py::TestATParallel011PolarizationFactor::test_unpolarized_theory PASSED [ 25%]
tests/test_at_parallel_011.py::TestATParallel011PolarizationFactor::test_polarized_kahn_model PASSED [ 25%]
tests/test_at_parallel_011.py::TestATParallel011PolarizationFactor::test_c_pytorch_equivalence SKIPPED [ 25%]
tests/test_at_parallel_012.py::TestATParallel012ReferencePatternCorrelation::test_simple_cubic_correlation PASSED [ 25%]
tests/test_at_parallel_012.py::TestATParallel012ReferencePatternCorrelation::test_triclinic_P1_correlation PASSED [ 25%]
tests/test_at_parallel_012.py::TestATParallel012ReferencePatternCorrelation::test_cubic_tilted_detector_correlation PASSED [ 25%]
tests/test_at_parallel_012.py::TestATParallel012ReferencePatternCorrelation::test_high_resolution_variant SKIPPED [ 25%]
tests/test_at_parallel_013.py::TestATParallel013CrossPlatformConsistency::test_pytorch_determinism_same_seed FAILED [ 26%]
tests/test_at_parallel_013.py::TestATParallel013CrossPlatformConsistency::test_pytorch_determinism_different_seeds FAILED [ 26%]
tests/test_at_parallel_013.py::TestATParallel013CrossPlatformConsistency::test_pytorch_consistency_across_runs FAILED [ 26%]
tests/test_at_parallel_013.py::TestATParallel013CrossPlatformConsistency::test_c_pytorch_equivalence SKIPPED [ 26%]
tests/test_at_parallel_013.py::TestATParallel013CrossPlatformConsistency::test_platform_fingerprint PASSED [ 26%]
tests/test_at_parallel_013.py::TestATParallel013CrossPlatformConsistency::test_numerical_precision_float64 PASSED [ 26%]
tests/test_at_parallel_014.py::TestATParallel014NoiseRobustness::test_mean_preservation_after_scaling PASSED [ 26%]
tests/test_at_parallel_014.py::TestATParallel014NoiseRobustness::test_peak_centroid_stability PASSED [ 27%]
tests/test_at_parallel_014.py::TestATParallel014NoiseRobustness::test_overload_count_consistency PASSED [ 27%]
tests/test_at_parallel_014.py::TestATParallel014NoiseRobustness::test_noise_statistics PASSED [ 27%]
tests/test_at_parallel_014.py::TestATParallel014NoiseRobustness::test_deterministic_noise_with_seed PASSED [ 27%]
tests/test_at_parallel_015.py::TestATParallel015MixedUnits::test_distance_units_consistency PASSED [ 27%]
tests/test_at_parallel_015.py::TestATParallel015MixedUnits::test_wavelength_units_consistency PASSED [ 27%]
tests/test_at_parallel_015.py::TestATParallel015MixedUnits::test_angle_units_consistency PASSED [ 27%]
tests/test_at_parallel_015.py::TestATParallel015MixedUnits::test_mixed_units_comprehensive PASSED [ 28%]
tests/test_at_parallel_015.py::TestATParallel015MixedUnits::test_detector_rotation_units PASSED [ 28%]
tests/test_at_parallel_016.py::TestATParallel016ExtremeScale::test_tiny_scale PASSED [ 28%]
tests/test_at_parallel_016.py::TestATParallel016ExtremeScale::test_large_cell PASSED [ 28%]
tests/test_at_parallel_016.py::TestATParallel016ExtremeScale::test_long_distance PASSED [ 28%]
tests/test_at_parallel_016.py::TestATParallel016ExtremeScale::test_extreme_scale_c_comparison SKIPPED [ 28%]
tests/test_at_parallel_016.py::TestATParallel016ExtremeScale::test_combined_extremes PASSED [ 28%]
tests/test_at_parallel_016.py::TestATParallel016ExtremeScale::test_numerical_stability_metrics PASSED [ 29%]
tests/test_at_parallel_017.py::TestATParallel017GrazingIncidence::test_large_detector_tilts FAILED [ 29%]
tests/test_at_parallel_017.py::TestATParallel017GrazingIncidence::test_large_twotheta FAILED [ 29%]
tests/test_at_parallel_017.py::TestATParallel017GrazingIncidence::test_combined_extreme_angles FAILED [ 29%]
tests/test_at_parallel_017.py::TestATParallel017GrazingIncidence::test_near_90_degree_incidence FAILED [ 29%]
tests/test_at_parallel_017.py::TestATParallel017GrazingIncidence::test_solid_angle_obliquity_corrections PASSED [ 29%]
tests/test_at_parallel_017.py::TestATParallel017GrazingIncidence::test_extreme_rotation_stability PASSED [ 29%]
tests/test_at_parallel_018.py::TestATParallel018CrystalBoundaryConditions::test_cubic_crystal_aligned_axes PASSED [ 30%]
tests/test_at_parallel_018.py::TestATParallel018CrystalBoundaryConditions::test_zero_angle_rotations PASSED [ 30%]
tests/test_at_parallel_018.py::TestATParallel018CrystalBoundaryConditions::test_near_singular_cell_angles PASSED [ 30%]
tests/test_at_parallel_018.py::TestATParallel018CrystalBoundaryConditions::test_aligned_spindle_and_beam PASSED [ 30%]
tests/test_at_parallel_018.py::TestATParallel018CrystalBoundaryConditions::test_very_small_unit_cell PASSED [ 30%]
tests/test_at_parallel_018.py::TestATParallel018CrystalBoundaryConditions::test_very_large_unit_cell PASSED [ 30%]
tests/test_at_parallel_018.py::TestATParallel018CrystalBoundaryConditions::test_continuity_near_90_degrees PASSED [ 30%]
tests/test_at_parallel_018.py::TestATParallel018CrystalBoundaryConditions::test_identity_misset_matrix PASSED [ 31%]
tests/test_at_parallel_020.py::TestATParallel020::test_comprehensive_integration SKIPPED [ 31%]
tests/test_at_parallel_020.py::TestATParallel020::test_comprehensive_without_absorption SKIPPED [ 31%]
tests/test_at_parallel_020.py::TestATParallel020::test_phi_rotation_only SKIPPED [ 31%]
tests/test_at_parallel_020.py::TestATParallel020::test_comprehensive_minimal_features SKIPPED [ 31%]
tests/test_at_parallel_021.py::TestCrystalPhiRotation::test_single_step_phi_rotation SKIPPED [ 31%]
tests/test_at_parallel_021.py::TestCrystalPhiRotation::test_multi_step_phi_rotation SKIPPED [ 31%]
tests/test_at_parallel_022.py::TestATParallel022::test_single_step_with_detector_rotations SKIPPED [ 32%]
tests/test_at_parallel_022.py::TestATParallel022::test_multi_step_with_detector_rotations SKIPPED [ 32%]
tests/test_at_parallel_022.py::TestATParallel022::test_large_detector_rotations SKIPPED [ 32%]
tests/test_at_parallel_023.py::TestAT_PARALLEL_023_MissetAnglesEquivalence::test_explicit_misset_equivalence[misset_angles0-cubic-cell_params0] SKIPPED [ 32%]
tests/test_at_parallel_023.py::TestAT_PARALLEL_023_MissetAnglesEquivalence::test_explicit_misset_equivalence[misset_angles0-triclinic-cell_params1] SKIPPED [ 32%]
tests/test_at_parallel_023.py::TestAT_PARALLEL_023_MissetAnglesEquivalence::test_explicit_misset_equivalence[misset_angles1-cubic-cell_params0] SKIPPED [ 32%]
tests/test_at_parallel_023.py::TestAT_PARALLEL_023_MissetAnglesEquivalence::test_explicit_misset_equivalence[misset_angles1-triclinic-cell_params1] SKIPPED [ 32%]
tests/test_at_parallel_023.py::TestAT_PARALLEL_023_MissetAnglesEquivalence::test_explicit_misset_equivalence[misset_angles2-cubic-cell_params0] SKIPPED [ 33%]
tests/test_at_parallel_023.py::TestAT_PARALLEL_023_MissetAnglesEquivalence::test_explicit_misset_equivalence[misset_angles2-triclinic-cell_params1] SKIPPED [ 33%]
tests/test_at_parallel_023.py::TestAT_PARALLEL_023_MissetAnglesEquivalence::test_explicit_misset_equivalence[misset_angles3-cubic-cell_params0] SKIPPED [ 33%]
tests/test_at_parallel_023.py::TestAT_PARALLEL_023_MissetAnglesEquivalence::test_explicit_misset_equivalence[misset_angles3-triclinic-cell_params1] SKIPPED [ 33%]
tests/test_at_parallel_023.py::TestAT_PARALLEL_023_MissetAnglesEquivalence::test_explicit_misset_equivalence[misset_angles4-cubic-cell_params0] SKIPPED [ 33%]
tests/test_at_parallel_023.py::TestAT_PARALLEL_023_MissetAnglesEquivalence::test_explicit_misset_equivalence[misset_angles4-triclinic-cell_params1] SKIPPED [ 33%]
tests/test_at_parallel_023.py::TestAT_PARALLEL_023_MissetAnglesEquivalence::test_misset_changes_pattern SKIPPED [ 33%]
tests/test_at_parallel_024.py::TestAT_PARALLEL_024::test_pytorch_determinism FAILED [ 34%]
tests/test_at_parallel_024.py::TestAT_PARALLEL_024::test_seed_independence FAILED [ 34%]
tests/test_at_parallel_024.py::TestAT_PARALLEL_024::test_c_pytorch_equivalence SKIPPED [ 34%]
tests/test_at_parallel_024.py::TestAT_PARALLEL_024::test_lcg_compatibility PASSED [ 34%]
tests/test_at_parallel_024.py::TestAT_PARALLEL_024::test_mosaic_rotation_umat_determinism FAILED [ 34%]
tests/test_at_parallel_024.py::TestAT_PARALLEL_024::test_umat2misset_round_trip PASSED [ 34%]
tests/test_at_parallel_025.py::test_maximum_intensity_simple_case SKIPPED [ 34%]
tests/test_at_parallel_025.py::test_maximum_intensity_with_offset SKIPPED [ 35%]
tests/test_at_parallel_025.py::test_maximum_intensity_triclinic SKIPPED  [ 35%]
tests/test_at_parallel_026.py::TestAT_PARALLEL_026_TriclinicAbsolutePosition::test_triclinic_absolute_peak_position_pytorch_only PASSED [ 35%]
tests/test_at_parallel_026.py::TestAT_PARALLEL_026_TriclinicAbsolutePosition::test_triclinic_absolute_peak_position_vs_c FAILED [ 35%]
tests/test_at_parallel_026.py::TestAT_PARALLEL_026_TriclinicAbsolutePosition::test_triclinic_vs_cubic_peak_difference PASSED [ 35%]
tests/test_at_parallel_027.py::TestAT_PARALLEL_027::test_structure_factor_loading PASSED [ 35%]
tests/test_at_parallel_027.py::TestAT_PARALLEL_027::test_intensity_ratios PASSED [ 35%]
tests/test_at_parallel_027.py::TestAT_PARALLEL_027::test_pattern_structure PASSED [ 36%]
tests/test_at_parallel_027.py::TestAT_PARALLEL_027::test_c_pytorch_equivalence SKIPPED [ 36%]
tests/test_at_parallel_027.py::TestAT_PARALLEL_027::test_f_squared_scaling PASSED [ 36%]
tests/test_at_parallel_028.py::TestATParallel028PerformanceParity::test_cpu_performance_parity SKIPPED [ 36%]
tests/test_at_parallel_028.py::TestATParallel028PerformanceParity::test_gpu_performance_superiority SKIPPED [ 36%]
tests/test_at_parallel_028.py::TestATParallel028PerformanceParity::test_performance_measurement_validity PASSED [ 36%]
tests/test_at_parallel_029.py::TestSubpixelSamplingAT029::test_pytorch_aliasing_reduction PASSED [ 36%]
tests/test_at_parallel_029.py::TestSubpixelSamplingAT029::test_pytorch_peak_stability PASSED [ 37%]
tests/test_at_parallel_029.py::TestSubpixelSamplingAT029::test_pytorch_fwhm_convergence PASSED [ 37%]
tests/test_at_parallel_029.py::TestSubpixelSamplingAT029::test_c_pytorch_oversample_equivalence SKIPPED [ 37%]
tests/test_at_parallel_029.py::TestSubpixelSamplingAT029::test_issue_subpixel_aliasing SKIPPED [ 37%]
tests/test_at_perf_001.py::TestATPERF001VectorizationPerformance::test_vectorization_scaling PASSED [ 37%]
tests/test_at_perf_001.py::TestATPERF001VectorizationPerformance::test_performance_parity_with_c SKIPPED [ 37%]
tests/test_at_perf_001.py::TestATPERF001VectorizationPerformance::test_memory_scaling PASSED [ 38%]
tests/test_at_perf_002.py::TestATPERF002ParallelExecution::test_cpu_thread_scaling PASSED [ 38%]
tests/test_at_perf_002.py::TestATPERF002ParallelExecution::test_pytorch_cpu_vs_c_performance SKIPPED [ 38%]
tests/test_at_perf_002.py::TestATPERF002ParallelExecution::test_gpu_acceleration PASSED [ 38%]
tests/test_at_perf_002.py::TestATPERF002ParallelExecution::test_thread_efficiency PASSED [ 38%]
tests/test_at_perf_003.py::TestATPERF003MemoryBandwidth::test_peak_memory_usage PASSED [ 38%]
tests/test_at_perf_003.py::TestATPERF003MemoryBandwidth::test_float32_vs_float64_performance PASSED [ 38%]
tests/test_at_perf_003.py::TestATPERF003MemoryBandwidth::test_cache_friendly_access PASSED [ 39%]
tests/test_at_perf_003.py::TestATPERF003MemoryBandwidth::test_memory_bandwidth_utilization PASSED [ 39%]
tests/test_at_perf_003.py::TestATPERF003MemoryBandwidth::test_intermediate_tensor_optimization PASSED [ 39%]
tests/test_at_perf_004.py::TestATPERF004HotPathOptimization::test_sincg_throughput PASSED [ 39%]
tests/test_at_perf_004.py::TestATPERF004HotPathOptimization::test_dot_product_throughput PASSED [ 39%]
tests/test_at_perf_004.py::TestATPERF004HotPathOptimization::test_profile_hot_paths PASSED [ 39%]
tests/test_at_perf_004.py::TestATPERF004HotPathOptimization::test_vectorization_efficiency PASSED [ 39%]
tests/test_at_perf_004.py::TestATPERF004HotPathOptimization::test_critical_operations_performance PASSED [ 40%]
tests/test_at_perf_005.py::TestATPERF005CompilationOptimization::test_torch_compile_speedup PASSED [ 40%]
tests/test_at_perf_005.py::TestATPERF005CompilationOptimization::test_hot_function_compilation PASSED [ 40%]
tests/test_at_perf_005.py::TestATPERF005CompilationOptimization::test_compilation_amortization PASSED [ 40%]
tests/test_at_perf_005.py::TestATPERF005CompilationOptimization::test_gpu_kernel_compilation PASSED [ 40%]
tests/test_at_perf_005.py::TestATPERF005CompilationOptimization::test_dtype_optimization_impact PASSED [ 40%]
tests/test_at_perf_006.py::TestATPERF006TensorVectorization::test_no_python_loops_in_core_path PASSED [ 40%]
tests/test_at_perf_006.py::TestATPERF006TensorVectorization::test_profile_tensor_operations_ratio PASSED [ 41%]
tests/test_at_perf_006.py::TestATPERF006TensorVectorization::test_vectorized_speedup PASSED [ 41%]
tests/test_at_perf_006.py::TestATPERF006TensorVectorization::test_tensor_shapes_include_all_dimensions SKIPPED [ 41%]
tests/test_at_perf_006.py::test_oversample_performance_scaling[1] PASSED [ 41%]
tests/test_at_perf_006.py::test_oversample_performance_scaling[2] PASSED [ 41%]
tests/test_at_perf_006.py::test_oversample_performance_scaling[3] PASSED [ 41%]
tests/test_at_perf_006.py::test_oversample_performance_scaling[4] PASSED [ 41%]
tests/test_at_perf_006.py::test_detector_thickness_vectorization PASSED  [ 42%]
tests/test_at_perf_007.py::TestATPerf007ComprehensiveBenchmark::test_benchmark_suite_execution SKIPPED [ 42%]
tests/test_at_perf_007.py::TestATPerf007ComprehensiveBenchmark::test_pytorch_performance_basic PASSED [ 42%]
tests/test_at_perf_007.py::TestATPerf007ComprehensiveBenchmark::test_memory_scaling PASSED [ 42%]
tests/test_at_perf_007.py::TestATPerf007ComprehensiveBenchmark::test_gpu_performance PASSED [ 42%]
tests/test_at_perf_007.py::TestATPerf007ComprehensiveBenchmark::test_benchmark_output_format PASSED [ 42%]
tests/test_at_perf_008.py::TestATPERF008CUDATensorResidency::test_large_tensor_gpu_residency PASSED [ 42%]
tests/test_at_perf_008.py::TestATPERF008CUDATensorResidency::test_auto_device_selection_uses_cuda PASSED [ 43%]
tests/test_at_perf_008.py::TestATPERF008CUDATensorResidency::test_skip_when_cuda_unavailable SKIPPED [ 43%]
tests/test_at_perf_008.py::TestATPERF008CUDATensorResidency::test_memory_efficient_gpu_usage PASSED [ 43%]
tests/test_at_pol_001.py::TestATPOL001KahnModel::test_polarization_factor_calculation PASSED [ 43%]
tests/test_at_pol_001.py::TestATPOL001KahnModel::test_nopolar_toggle PASSED [ 43%]
tests/test_at_pol_001.py::TestATPOL001KahnModel::test_oversample_polar_last_value_semantics PASSED [ 43%]
tests/test_at_pol_001.py::TestATPOL001KahnModel::test_polarization_with_tilted_detector PASSED [ 43%]
tests/test_at_pol_001.py::TestATPOL001KahnModel::test_polarization_factor_range PASSED [ 44%]
tests/test_at_pre_001.py::test_header_precedence_img_then_mask PASSED    [ 44%]
tests/test_at_pre_001.py::test_mask_beam_center_y_flip PASSED            [ 44%]
tests/test_at_pre_001.py::test_img_only_no_mask PASSED                   [ 44%]
tests/test_at_pre_002.py::test_xbeam_ybeam_forces_beam_pivot PASSED      [ 44%]
tests/test_at_pre_002.py::test_xclose_yclose_forces_sample_pivot PASSED  [ 44%]
tests/test_at_pre_002.py::test_orgx_orgy_forces_sample_pivot PASSED      [ 44%]
tests/test_at_pre_002.py::test_explicit_pivot_override PASSED            [ 45%]
tests/test_at_pre_002.py::test_distance_vs_close_distance_pivot_defaults PASSED [ 45%]
tests/test_at_pre_002.py::test_convention_default_pivots PASSED          [ 45%]
tests/test_at_roi_001.py::TestAT_ROI_001::test_roi_bounds_default_to_full_detector PASSED [ 45%]
tests/test_at_roi_001.py::TestAT_ROI_001::test_roi_bounds_validation PASSED [ 45%]
tests/test_at_roi_001.py::TestAT_ROI_001::test_roi_limits_rendering_area PASSED [ 45%]
tests/test_at_roi_001.py::TestAT_ROI_001::test_mask_array_filtering PASSED [ 45%]
tests/test_at_roi_001.py::TestAT_ROI_001::test_roi_and_mask_combination PASSED [ 46%]
tests/test_at_roi_001.py::TestAT_ROI_001::test_mask_array_dimension_validation PASSED [ 46%]
tests/test_at_roi_001.py::TestAT_ROI_001::test_statistics_exclude_masked_pixels PASSED [ 46%]
tests/test_at_sam_001.py::test_at_sam_001_steps_normalization PASSED     [ 46%]
tests/test_at_sam_002.py::TestAT_SAM_002_OversampleLastValue::test_oversample_omega_last_value_semantics PASSED [ 46%]
tests/test_at_sam_002.py::TestAT_SAM_002_OversampleLastValue::test_oversample_without_subpixel_flags PASSED [ 46%]
tests/test_at_sam_002.py::TestAT_SAM_002_OversampleLastValue::test_oversample_flag_precedence PASSED [ 46%]
tests/test_at_sam_003.py::test_dmin_culling_basic PASSED                 [ 47%]
tests/test_at_sam_003.py::test_dmin_culling_exact_threshold PASSED       [ 47%]
tests/test_at_sam_003.py::test_dmin_zero_no_culling PASSED               [ 47%]
tests/test_at_src_001.py::TestAT_SRC_001_SourcefileAndWeighting::test_sourcefile_with_all_columns FAILED [ 47%]
tests/test_at_src_001.py::TestAT_SRC_001_SourcefileAndWeighting::test_sourcefile_with_missing_columns FAILED [ 47%]
tests/test_at_src_001.py::TestAT_SRC_001_SourcefileAndWeighting::test_sourcefile_default_position FAILED [ 47%]
tests/test_at_src_001.py::TestAT_SRC_001_SourcefileAndWeighting::test_multiple_sources_normalization FAILED [ 47%]
tests/test_at_src_001.py::TestAT_SRC_001_SourcefileAndWeighting::test_empty_sourcefile PASSED [ 48%]
tests/test_at_src_001.py::TestAT_SRC_001_SourcefileAndWeighting::test_weighted_sources_integration FAILED [ 48%]
tests/test_at_src_001_cli.py::TestAT_SRC_001_CLI::test_sourcefile_loading_via_cli PASSED [ 48%]
tests/test_at_src_001_cli.py::TestAT_SRC_001_CLI::test_sourcefile_with_missing_columns PASSED [ 48%]
tests/test_at_src_001_cli.py::TestAT_SRC_001_CLI::test_sourcefile_takes_precedence_over_divergence PASSED [ 48%]
tests/test_at_src_001_simple.py::test_sourcefile_parsing FAILED          [ 48%]
tests/test_at_src_002.py::TestAT_SRC_002::test_no_parameters_provided PASSED [ 48%]
tests/test_at_src_002.py::TestAT_SRC_002::test_only_step_provided PASSED [ 49%]
tests/test_at_src_002.py::TestAT_SRC_002::test_only_range_provided PASSED [ 49%]
tests/test_at_src_002.py::TestAT_SRC_002::test_only_count_provided_angles PASSED [ 49%]
tests/test_at_src_002.py::TestAT_SRC_002::test_only_count_provided_thickness PASSED [ 49%]
tests/test_at_src_002.py::TestAT_SRC_002::test_range_and_step_provided PASSED [ 49%]
tests/test_at_src_002.py::TestAT_SRC_002::test_count_and_range_provided PASSED [ 49%]
tests/test_at_src_002.py::TestAT_SRC_002::test_divergence_auto_selection PASSED [ 50%]
tests/test_at_src_002.py::TestAT_SRC_002::test_dispersion_auto_selection PASSED [ 50%]
tests/test_at_src_002.py::TestAT_SRC_002::test_thickness_auto_selection PASSED [ 50%]
tests/test_at_src_002.py::TestAT_SRC_002::test_all_parameters_provided PASSED [ 50%]
tests/test_at_src_002.py::TestAT_SRC_002::test_conflicting_parameters PASSED [ 50%]
tests/test_at_src_003.py::TestSourcefileLambdaOverride::test_lambda_override_single_source PASSED [ 50%]
tests/test_at_src_003.py::TestSourcefileLambdaOverride::test_lambda_override_multiple_sources PASSED [ 50%]
tests/test_at_src_003.py::TestSourcefileWarningEmission::test_warning_emitted_on_mismatch PASSED [ 51%]
tests/test_at_src_003.py::TestSourcefileWarningEmission::test_no_warning_when_matching PASSED [ 51%]
tests/test_at_src_003.py::TestSourcefileWarningEmission::test_no_warning_when_column_missing PASSED [ 51%]
tests/test_at_src_003.py::TestStepsNormalizationParity::test_steps_count_includes_zero_weight_sources PASSED [ 51%]
tests/test_at_src_003.py::TestStepsNormalizationParity::test_equal_weighting_preserved PASSED [ 51%]
tests/test_at_sta_001.py::TestAT_STA_001::test_statistics_basic PASSED   [ 51%]
tests/test_at_sta_001.py::TestAT_STA_001::test_statistics_with_roi PASSED [ 51%]
tests/test_at_sta_001.py::TestAT_STA_001::test_statistics_with_mask PASSED [ 52%]
tests/test_at_sta_001.py::TestAT_STA_001::test_statistics_empty_roi PASSED [ 52%]
tests/test_at_sta_001.py::TestAT_STA_001::test_statistics_last_max_location PASSED [ 52%]
tests/test_at_str_001.py::test_at_str_001_nearest_neighbor_lookup PASSED [ 52%]
tests/test_at_str_002.py::test_tricubic_interpolation_enabled PASSED     [ 52%]
tests/test_at_str_002.py::test_tricubic_out_of_bounds_fallback PASSED    [ 52%]
tests/test_at_str_002.py::test_auto_enable_interpolation PASSED          [ 52%]
tests/test_at_str_003.py::TestAT_STR_003_LatticeShapeModels::test_square_shape_model PASSED [ 53%]
tests/test_at_str_003.py::TestAT_STR_003_LatticeShapeModels::test_round_shape_model PASSED [ 53%]
tests/test_at_str_003.py::TestAT_STR_003_LatticeShapeModels::test_gauss_shape_model FAILED [ 53%]
tests/test_at_str_003.py::TestAT_STR_003_LatticeShapeModels::test_tophat_shape_model PASSED [ 53%]
tests/test_at_str_003.py::TestAT_STR_003_LatticeShapeModels::test_shape_model_comparison FAILED [ 53%]
tests/test_at_str_003.py::TestAT_STR_003_LatticeShapeModels::test_fudge_parameter_scaling PASSED [ 53%]
tests/test_at_str_003.py::TestAT_STR_003_LatticeShapeModels::test_shape_models_at_bragg_peak PASSED [ 53%]
tests/test_at_str_004.py::TestAT_STR_004::test_sparse_hkl_loading PASSED [ 54%]
tests/test_at_str_004.py::TestAT_STR_004::test_missing_reflection_uses_default_f PASSED [ 54%]
tests/test_at_str_004.py::TestAT_STR_004::test_intensity_ratios_with_sparse_hkl PASSED [ 54%]
tests/test_at_str_004.py::TestAT_STR_004::test_fallback_with_no_hkl_uses_default_f PASSED [ 54%]
tests/test_at_str_004.py::TestAT_STR_004::test_fdump_preserves_sparse_behavior PASSED [ 54%]
tests/test_at_tools_001.py::TestAT_TOOLS_001_DualRunnerComparison::test_find_c_binary_resolution PASSED [ 54%]
tests/test_at_tools_001.py::TestAT_TOOLS_001_DualRunnerComparison::test_find_py_binary_resolution PASSED [ 54%]
tests/test_at_tools_001.py::TestAT_TOOLS_001_DualRunnerComparison::test_load_float_image PASSED [ 55%]
tests/test_at_tools_001.py::TestAT_TOOLS_001_DualRunnerComparison::test_resample_image PASSED [ 55%]
tests/test_at_tools_001.py::TestAT_TOOLS_001_DualRunnerComparison::test_compute_metrics PASSED [ 55%]
tests/test_at_tools_001.py::TestAT_TOOLS_001_DualRunnerComparison::test_find_peaks PASSED [ 55%]
tests/test_at_tools_001.py::TestAT_TOOLS_001_DualRunnerComparison::test_script_integration FAILED [ 55%]
tests/test_at_tools_001.py::TestAT_TOOLS_001_DualRunnerComparison::test_metrics_with_identical_images PASSED [ 55%]
tests/test_at_tools_001.py::TestAT_TOOLS_001_DualRunnerComparison::test_metrics_with_scaled_images PASSED [ 55%]
tests/test_cli_flags.py::TestPix0VectorAlias::test_pix0_meters_alias PASSED [ 56%]
tests/test_cli_flags.py::TestPix0VectorAlias::test_pix0_millimeter_alias PASSED [ 56%]
tests/test_cli_flags.py::TestPix0VectorAlias::test_pix0_meters_and_mm_equivalence PASSED [ 56%]
tests/test_cli_flags.py::TestPix0VectorAlias::test_dual_pix0_flag_rejection PASSED [ 56%]
tests/test_cli_flags.py::TestPix0VectorAlias::test_pix0_signed_combinations[pix0_m0-pix0_mm0] PASSED [ 56%]
tests/test_cli_flags.py::TestPix0VectorAlias::test_pix0_signed_combinations[pix0_m1-pix0_mm1] PASSED [ 56%]
tests/test_cli_flags.py::TestPix0VectorAlias::test_pix0_signed_combinations[pix0_m2-pix0_mm2] PASSED [ 56%]
tests/test_cli_flags.py::TestDetectorOverridePersistence::test_detector_override_persistence_cpu PASSED [ 57%]
tests/test_cli_flags.py::TestDetectorOverridePersistence::test_detector_override_persistence_cuda PASSED [ 57%]
tests/test_cli_flags.py::TestDetectorOverridePersistence::test_detector_override_dtype_preservation PASSED [ 57%]
tests/test_cli_flags.py::TestNoiseSuppressionFlag::test_nonoise_suppresses_noise_output PASSED [ 57%]
tests/test_cli_flags.py::TestNoiseSuppressionFlag::test_noisefile_without_nonoise PASSED [ 57%]
tests/test_cli_flags.py::TestNoiseSuppressionFlag::test_nonoise_preserves_seed PASSED [ 57%]
tests/test_cli_flags.py::TestNoiseSuppressionFlag::test_nonoise_without_noisefile PASSED [ 57%]
tests/test_cli_flags.py::TestCLIIntegrationSanity::test_pix0_does_not_alter_beam_vector PASSED [ 58%]
tests/test_cli_flags.py::TestCLIIntegrationSanity::test_pix0_triggers_custom_convention PASSED [ 58%]
tests/test_cli_flags.py::TestCLIIntegrationSanity::test_roi_unaffected_by_new_flags PASSED [ 58%]
tests/test_cli_flags.py::TestCLIIntegrationSanity::test_convention_preserved_without_pix0 PASSED [ 58%]
tests/test_cli_flags.py::TestCLIBeamVector::test_custom_beam_vector_propagates PASSED [ 58%]
tests/test_cli_flags.py::TestCLIPix0Override::test_pix0_override_beam_pivot_transform[cpu-dtype0] PASSED [ 58%]
tests/test_cli_flags.py::TestCLIPix0Override::test_pix0_override_beam_pivot_transform[cuda-dtype1] PASSED [ 58%]
tests/test_cli_flags.py::TestCLIPix0Override::test_pix0_vector_mm_beam_pivot[cpu] FAILED [ 59%]
tests/test_cli_flags.py::TestCLIPix0Override::test_pix0_vector_mm_beam_pivot[cuda] FAILED [ 59%]
tests/test_cli_flags.py::TestCLIPolarization::test_default_polarization_parity PASSED [ 59%]
tests/test_cli_flags.py::TestCLIPolarization::test_nopolar_flag PASSED   [ 59%]
tests/test_cli_flags.py::TestCLIPolarization::test_polar_override PASSED [ 59%]
tests/test_cli_flags.py::TestCLIPivotSelection::test_custom_vectors_force_sample_pivot[float32-cpu] PASSED [ 59%]
tests/test_cli_flags.py::TestCLIPivotSelection::test_custom_vectors_force_sample_pivot[float32-cuda] PASSED [ 59%]
tests/test_cli_flags.py::TestCLIPivotSelection::test_custom_vectors_force_sample_pivot[float64-cpu] PASSED [ 60%]
tests/test_cli_flags.py::TestCLIPivotSelection::test_custom_vectors_force_sample_pivot[float64-cuda] PASSED [ 60%]
tests/test_cli_flags.py::TestHKLFdumpParity::test_scaled_hkl_roundtrip FAILED [ 60%]
tests/test_cli_scaling.py::TestMOSFLMCellVectors::test_mosflm_cell_vectors SKIPPED [ 60%]
tests/test_cli_scaling.py::TestFlattSquareMatchesC::test_f_latt_square_matches_c SKIPPED [ 60%]
tests/test_cli_scaling.py::TestSourceWeights::test_source_weights_ignored_per_spec PASSED [ 60%]
tests/test_cli_scaling.py::TestSourceWeights::test_cli_lambda_overrides_sourcefile PASSED [ 60%]
tests/test_cli_scaling.py::TestSourceWeights::test_uniform_weights_ignored PASSED [ 61%]
tests/test_cli_scaling.py::TestSourceWeights::test_edge_case_zero_sum_accepted PASSED [ 61%]
tests/test_cli_scaling.py::TestSourceWeights::test_edge_case_negative_weights_accepted PASSED [ 61%]
tests/test_cli_scaling.py::TestSourceWeights::test_single_source_fallback PASSED [ 61%]
tests/test_cli_scaling.py::TestSourceWeightsDivergence::test_c_divergence_reference SKIPPED [ 61%]
tests/test_cli_scaling.py::TestSourceWeightsDivergence::test_sourcefile_divergence_warning SKIPPED [ 61%]
tests/test_cli_scaling.py::TestHKLDevice::test_hkl_tensor_respects_device[cpu-float32] SKIPPED [ 61%]
tests/test_cli_scaling.py::TestHKLDevice::test_hkl_tensor_respects_device[cpu-float64] SKIPPED [ 62%]
tests/test_cli_scaling.py::TestHKLDevice::test_hkl_tensor_respects_device[cuda-float32] SKIPPED [ 62%]
tests/test_cli_scaling.py::TestHKLDevice::test_hkl_tensor_respects_device[cuda-float64] SKIPPED [ 62%]
tests/test_cli_scaling_phi0.py::TestPhiZeroParity::test_rot_b_matches_c SKIPPED [ 62%]
tests/test_cli_scaling_phi0.py::TestPhiZeroParity::test_k_frac_phi0_matches_c SKIPPED [ 62%]
tests/test_configuration_consistency.py::TestConfigurationConsistency::test_explicit_defaults_equal_implicit XFAIL [ 62%]
tests/test_configuration_consistency.py::TestConfigurationConsistency::test_configuration_echo_present SKIPPED [ 63%]
tests/test_configuration_consistency.py::TestConfigurationConsistency::test_mode_detection_accuracy SKIPPED [ 63%]
tests/test_configuration_consistency.py::TestConfigurationConsistency::test_trigger_tracking SKIPPED [ 63%]
tests/test_configuration_consistency.py::TestConfigurationConsistency::test_all_vector_parameters_trigger_custom SKIPPED [ 63%]
tests/test_crystal_geometry.py::TestCrystalGeometry::test_cubic_regression PASSED [ 63%]
tests/test_crystal_geometry.py::TestCrystalGeometry::test_triclinic_correctness PASSED [ 63%]
tests/test_crystal_geometry.py::TestCrystalGeometry::test_metric_duality PASSED [ 63%]
tests/test_crystal_geometry.py::TestCrystalGeometry::test_volume_identity PASSED [ 64%]
tests/test_crystal_geometry.py::TestCrystalGeometry::test_resolution_shell_consistency PASSED [ 64%]
tests/test_crystal_geometry.py::TestCrystalGeometry::test_rotation_invariance PASSED [ 64%]
tests/test_crystal_geometry.py::TestCrystalGeometry::test_gradient_flow PASSED [ 64%]
tests/test_crystal_geometry.py::TestCrystalGeometry::test_angles_to_rotation_matrix_identity PASSED [ 64%]
tests/test_crystal_geometry.py::TestCrystalGeometry::test_angles_to_rotation_matrix_x_rotation PASSED [ 64%]
tests/test_crystal_geometry.py::TestCrystalGeometry::test_angles_to_rotation_matrix_y_rotation PASSED [ 64%]
tests/test_crystal_geometry.py::TestCrystalGeometry::test_angles_to_rotation_matrix_z_rotation PASSED [ 65%]
tests/test_crystal_geometry.py::TestCrystalGeometry::test_angles_to_rotation_matrix_order PASSED [ 65%]
tests/test_crystal_geometry.py::TestCrystalGeometry::test_angles_to_rotation_matrix_properties PASSED [ 65%]
tests/test_crystal_geometry.py::TestCrystalGeometry::test_angles_to_rotation_matrix_tensor_types PASSED [ 65%]
tests/test_crystal_geometry.py::TestCrystalGeometry::test_misset_orientation PASSED [ 65%]
tests/test_crystal_geometry.py::TestCrystalGeometry::test_misset_zero_rotation PASSED [ 65%]
tests/test_crystal_geometry.py::TestCrystalGeometry::test_misset_tensor_inputs PASSED [ 65%]
tests/test_crystal_geometry.py::TestCrystalGeometry::test_misset_rotation_order PASSED [ 66%]
tests/test_crystal_geometry.py::TestCrystalGeometry::test_misset_gradient_flow PASSED [ 66%]
tests/test_custom_vectors.py::TestCustomVectors::test_custom_vectors_in_detector_config PASSED [ 66%]
tests/test_custom_vectors.py::TestCustomVectors::test_custom_vectors_in_detector PASSED [ 66%]
tests/test_custom_vectors.py::TestCustomVectors::test_cli_custom_vectors PASSED [ 66%]
tests/test_custom_vectors.py::TestCustomVectors::test_custom_convention_detection PASSED [ 66%]
tests/test_custom_vectors.py::TestCustomVectors::test_custom_spindle_axis PASSED [ 66%]
tests/test_debug_trace.py::TestDebugTraceFeatures::test_printout_flag FAILED [ 67%]
tests/test_debug_trace.py::TestDebugTraceFeatures::test_printout_pixel_flag PASSED [ 67%]
tests/test_debug_trace.py::TestDebugTraceFeatures::test_trace_pixel_flag FAILED [ 67%]
tests/test_debug_trace.py::TestDebugTraceFeatures::test_combined_debug_flags FAILED [ 67%]
tests/test_debug_trace.py::TestDebugTraceFeatures::test_out_of_bounds_pixel FAILED [ 67%]
tests/test_detector_basis_vectors.py::TestDetectorBasisVectors::test_default_mosflm_convention PASSED [ 67%]
tests/test_detector_basis_vectors.py::TestDetectorBasisVectors::test_default_xds_convention PASSED [ 67%]
tests/test_detector_basis_vectors.py::TestDetectorBasisVectors::test_single_axis_rotations PASSED [ 68%]
tests/test_detector_basis_vectors.py::TestDetectorBasisVectors::test_combined_rotations PASSED [ 68%]
tests/test_detector_basis_vectors.py::TestDetectorBasisVectors::test_twotheta_rotation PASSED [ 68%]
tests/test_detector_basis_vectors.py::TestDetectorBasisVectors::test_all_rotations_combined PASSED [ 68%]
tests/test_detector_basis_vectors.py::TestDetectorBasisVectors::test_tensor_rotation_parameters PASSED [ 68%]
tests/test_detector_config.py::TestDetectorConfig::test_default_values PASSED [ 68%]
tests/test_detector_config.py::TestDetectorConfig::test_post_init_defaults PASSED [ 68%]
tests/test_detector_config.py::TestDetectorConfig::test_custom_twotheta_axis PASSED [ 69%]
tests/test_detector_config.py::TestDetectorConfig::test_xds_convention_defaults PASSED [ 69%]
tests/test_detector_config.py::TestDetectorConfig::test_invalid_pixel_counts PASSED [ 69%]
tests/test_detector_config.py::TestDetectorConfig::test_invalid_distance PASSED [ 69%]
tests/test_detector_config.py::TestDetectorConfig::test_invalid_pixel_size PASSED [ 69%]
tests/test_detector_config.py::TestDetectorConfig::test_invalid_oversample PASSED [ 69%]
tests/test_detector_config.py::TestDetectorConfig::test_tensor_parameters PASSED [ 69%]
tests/test_detector_config.py::TestDetectorInitialization::test_default_initialization FAILED [ 70%]
tests/test_detector_config.py::TestDetectorInitialization::test_custom_config_initialization FAILED [ 70%]
tests/test_detector_config.py::TestDetectorInitialization::test_backward_compatibility_check PASSED [ 70%]
tests/test_detector_config.py::TestDetectorInitialization::test_custom_config_not_default PASSED [ 70%]
tests/test_detector_config.py::TestDetectorInitialization::test_basis_vectors_initialization PASSED [ 70%]
tests/test_detector_config.py::TestDetectorInitialization::test_device_and_dtype PASSED [ 70%]
tests/test_detector_conventions.py::TestDetectorConventions::test_adxv_convention_basis_vectors PASSED [ 70%]
tests/test_detector_conventions.py::TestDetectorConventions::test_denzo_convention_basis_vectors PASSED [ 71%]
tests/test_detector_conventions.py::TestDetectorConventions::test_denzo_beam_center_mapping FAILED [ 71%]
tests/test_detector_conventions.py::TestDetectorConventions::test_adxv_beam_direction PASSED [ 71%]
tests/test_detector_conventions.py::TestDetectorConventions::test_adxv_twotheta_axis_default PASSED [ 71%]
tests/test_detector_conventions.py::TestDetectorConventions::test_denzo_twotheta_axis_default PASSED [ 71%]
tests/test_detector_conventions.py::TestDetectorConventions::test_adxv_default_beam_centers PASSED [ 71%]
tests/test_detector_conventions.py::TestDetectorConventions::test_all_conventions_orthonormal PASSED [ 71%]
tests/test_detector_conventions.py::TestDetectorConventions::test_conventions_with_rotations PASSED [ 72%]
tests/test_detector_geometry.py::TestDetectorGeometryRegressions::test_rotated_basis_vectors_match_c_reference PASSED [ 72%]
tests/test_detector_geometry.py::TestDetectorGeometryRegressions::test_pix0_vector_matches_c_reference_in_beam_pivot PASSED [ 72%]
tests/test_detector_geometry.py::TestDetectorGeometryRegressions::test_mosflm_axis_mapping_correctness PASSED [ 72%]
tests/test_detector_geometry.py::TestDetectorDifferentiability::test_detector_parameter_gradients PASSED [ 72%]
tests/test_detector_geometry.py::TestDetectorDifferentiability::test_basis_vector_gradients PASSED [ 72%]
tests/test_detector_geometry.py::TestDetectorDifferentiability::test_pixel_coords_basis_vector_gradients PASSED [ 72%]
tests/test_detector_geometry.py::TestDetectorDifferentiability::test_comprehensive_gradcheck PASSED [ 73%]
tests/test_detector_geometry.py::TestDetectorDifferentiability::test_beam_strike_invariant_in_beam_pivot_mode PASSED [ 73%]
tests/test_detector_geometry.py::TestDetectorDifferentiability::test_xds_convention_basic_geometry PASSED [ 73%]
tests/test_detector_geometry.py::TestDetectorDifferentiability::test_detector_real_valued_gradients PASSED [ 73%]
tests/test_detector_geometry.py::TestDetectorDifferentiability::test_detector_complex_gradient_edge_cases PASSED [ 73%]
tests/test_detector_geometry.py::TestDetectorDifferentiability::test_simulator_real_valued_gradients PASSED [ 73%]
tests/test_detector_pivots.py::test_beam_pivot_keeps_beam_indices_and_alignment FAILED [ 73%]
tests/test_detector_pivots.py::test_sample_pivot_moves_beam_indices_with_twotheta FAILED [ 74%]
tests/test_divergence_culling.py::TestDivergenceCullingModes::test_round_div_applies_elliptical_trimming PASSED [ 74%]
tests/test_divergence_culling.py::TestDivergenceCullingModes::test_square_div_uses_full_grid PASSED [ 74%]
tests/test_divergence_culling.py::TestDivergenceCullingModes::test_round_vs_square_source_count_difference PASSED [ 74%]
tests/test_divergence_culling.py::TestDivergenceCullingModes::test_single_divergence_point_unaffected PASSED [ 74%]
tests/test_divergence_culling.py::TestDivergenceCullingModes::test_elliptical_trimming_threshold PASSED [ 74%]
tests/test_divergence_culling.py::TestDivergenceCullingModes::test_combined_divergence_and_dispersion PASSED [ 75%]
tests/test_gradients.py::TestCellParameterGradients::test_gradcheck_cell_a PASSED [ 75%]
tests/test_gradients.py::TestCellParameterGradients::test_gradcheck_cell_b 